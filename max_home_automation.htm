<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML lang="en">
<HEAD>
<link REL="SHORTCUT ICON" href="http://www.dmitry-kazakov.de/favicon.ico">
  <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <META name="keywords" content="Ada, Ada 95, Ada 2005, GTK, GTK+, GtkAda, MAX! cube, ELV, eQ-3, radiator thermostat, MQTT">
  <META name="Author" content="Dmitry Kazakov">
  <META name="Description" content="GNAT Programming Studio Library Installer">
  <TITLE>MAX! cube home automation</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF" link="#0000FF" vlink="#800080">
<P align="center">
<BIG><BIG><BIG><B>MAX! HOME AUTOMATION</B></BIG></BIG><BR>
<EM>version 5.0</EM><BR>
by Dmitry A. Kazakov</BIG><BR>
(<A HREF="mailto:mailbox@dmitry-kazakov.de">mailbox@dmitry-kazakov.de</A>)<br>
<a href="http://www.dmitry-kazakov.de">
<img border="0" src="home.jpg" alt="[Home]" width="40" height="40"></a></p>
<P>
This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option) any later
version.<br>
<br>
This program is distributed in the hope that it will be useful, but WITHOUT ANY 
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A 
PARTICULAR PURPOSE. See the GNU General Public License for more details.<br>
<br>
You should have received a copy of the
<a href="http://www.gnu.org/licenses/gpl.html">GNU General Public License</a> 
along with this program; if not, write to the Free Software Foundation, Inc., 
675 Mass Ave, Cambridge, MA 02139, USA.</P>
<HR>
<P>
MAX! home automation is a <a href="http://www.gtk.org">GTK+</a> application to 
manage ELV/eQ-3 MAX! cubes. A cube is a gateway to a network of radiator 
thermostats, shutter contacts etc. The application provides:</P>
<ul>
	<li>Access and control over HTTP rest API;</li>
	<li>Access and control over an integrated MQTT broker;</li>
	<li>Python scripting support;</li>
	<li>Data logger backed by a database, most commonly databases are supported 
	over ODBC;</li>
	<li>Set and is temperatures graphs;</li>
	<li>E-mail notifications of the low battery status.</li>
</ul>
<table border="0" cellspacing="0" cellpadding="0" style="border-top-width: 0px">
	<tr>
		<td style="border-top-style: none; border-top-width: medium" colspan="4">&nbsp;</td>
		<td style="border-top-style: none; border-top-width: medium" align="right">
		&nbsp;</td>
		<td>&nbsp;</td>
		<td align="center" colspan="2">
		ARM</td>
		<td align="center" colspan="2">
		Intel</td>
	</tr>
	<tr>
		<td style="border-top-style: none; border-top-width: medium" colspan="4"><b>Download 
		MAX! home automation</b></td>
		<td style="border-top-style: none; border-top-width: medium" align="right">
		<b>Platform:</b></td>
		<td>&nbsp;</td>
		<td align="center">
		&nbsp;</td>
		<td align="center">
		v7</td>
		<td align="center">
		64-</td>
		<td align="center">
		32bit</td>
	</tr>
	<tr>
		<td style="border-top-style: solid; border-top-width: 1px">Fedora packages	
		</td>
		<td style="border-top-style: solid; border-top-width: 1px" align="center">	
		<img border="0" src="fedora-logo.jpg" width="16" height="16" alt="fedora"></td>
		<td style="border-top-style: solid; border-top-width: 1px">&nbsp;&nbsp;&nbsp;&nbsp; </td>
		<td style="border-top-style: solid; border-top-width: 1px">precompiled and packaged using RPM</td>
		<td style="border-top-style: solid; border-top-width: 1px">&nbsp;</td>
		<td>&nbsp;</td>
		<td align="right">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_fedora_aarch64.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="right">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_fedora_armv7hl.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_fedora_x86_64.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_fedora_i686.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
	</tr>
	<tr>
		<td style="border-top-style: solid; border-top-width: 1px">CentOS packages </td>
		<td style="border-top-style: solid; border-top-width: 1px" align="center">	
		<img border="0" src="centos-logo.jpg" width="16" height="16" alt="CentOS"></td>
		<td style="border-top-style: solid; border-top-width: 1px">&nbsp;</td>
		<td style="border-top-style: solid; border-top-width: 1px">precompiled and packaged using RPM</td>
		<td style="border-top-style: solid; border-top-width: 1px">&nbsp;</td>
		<td>&nbsp;</td>
		<td align="right">
		&nbsp;</td>
		<td align="right">
		&nbsp;</td>
		<td align="center"><a href="http://www.dmitry-kazakov.de/distributions/centos/max_home_automation_centos_x86_64.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center"><a href="http://www.dmitry-kazakov.de/distributions/centos/max_home_automation_centos_i686.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
	</tr>
	<tr>
		<td style="border-top-style: solid; border-top-width: 1px; ">Debian packages </td>
		<td style="border-top-style: solid; border-top-width: 1px; " align="center">	<img border="0" src="debian-logo.jpg" width="16" height="16" alt="Debian"></td>
		<td style="border-top-style: solid; border-top-width: 1px; ">&nbsp;</td>
		<td style="border-top-style: solid; border-top-width: 1px; " colspan="2">precompiled and packaged for dpkg</td>
		<td>&nbsp;</td>
		<td align="right">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_debian_aarch64.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="right">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_debian_armhf.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_debian_x86_64.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center">
		<a href="http://www.dmitry-kazakov.de/distributions/max_home_automation_debian_i686.htm">
		<img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
	</tr>
	<tr>
		<td style="border-top-style: solid; border-top-width: 1px; border-bottom-style: solid; border-bottom-width: 1px">Ubuntu packages </td>
		<td style="border-top-style: solid; border-top-width: 1px; border-bottom-style: solid; border-bottom-width: 1px" align="center"> <img border="0" src="ubuntu-logo.jpg" width="16" height="16" alt="Ubuntu"></td>
		<td style="border-top-style: solid; border-top-width: 1px; border-bottom-style: solid; border-bottom-width: 1px">&nbsp;</td>
		<td style="border-top-style: solid; border-top-width: 1px; border-bottom-style: solid; border-bottom-width: 1px" colspan="2">precompiled and packaged for dpkg</td>
		<td>&nbsp;</td>
		<td align="right"><a href="http://www.dmitry-kazakov.de/distributions/ubuntu/max_home_automation_ubuntu_aarch64.htm"><img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="right"><a href="http://www.dmitry-kazakov.de/distributions/ubuntu/max_home_automation_ubuntu_armhf.htm"><img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center"><a href="http://www.dmitry-kazakov.de/distributions/ubuntu/max_home_automation_ubuntu_x86_64.htm"><img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
		<td align="center"><a href="http://www.dmitry-kazakov.de/distributions/ubuntu/max_home_automation_ubuntu_i686.htm"><img src="in.jpg" align=middle alt="[Download page]" width="29" height="29"></a></td>
	</tr>
	<tr>
		<td style="border-bottom-style: solid; border-bottom-width: 1px">Windows 
		installer</td>
		<td style="border-bottom-style: solid; border-bottom-width: 1px" align="center">&nbsp;</td>
		<td style="border-bottom-style: solid; border-bottom-width: 1px">&nbsp;</td>
		<td style="border-bottom-style: solid; border-bottom-width: 1px" colspan="2"><a href="http://www.dmitry-kazakov.de/ada/max_home_automation_setup_5_0.exe">
		max_home_automation_setup_5_0.exe</a> (dual installer for 32- and 
		64-bit Windows versions)</td>
		<td>&nbsp;</td>
		<td colspan="4" align="center"><a href="http://www.dmitry-kazakov.de/ada/max_home_automation_setup_5_0.exe"><img src="download.jpg" align=middle alt="[Download]" width="29" height="29"></a></td>
	</tr>
	<tr>
		<td style="border-bottom-style: solid; border-bottom-width: 1px" colspan="2">Source distribution (any platform)</td>
		<td style="border-bottom-style: solid; border-bottom-width: 1px">&nbsp;</td>
		<td style="border-bottom-style: solid; border-bottom-width: 1px" colspan="2"><a href="http://www.dmitry-kazakov.de/ada/max_home_automation_5_0.tgz">
		max_home_automation_5_0.tgz</a>
		(<b>tar</b> + <b>gzip</b>, Windows users may use WinZip)</td>
		<td>&nbsp;</td>
		<td colspan="4" align="center">
		<a href="http://www.dmitry-kazakov.de/ada/max_home_automation_5_0.tgz">
		<img src="download.jpg" align=middle alt="[Download]" width="29" height="29"></a></td>
	</tr>
</table>
<p>See also the <a href="#changes_log">changes log</a>.</p>
<p>The application is based on the ELV/eQ-3 cube client protocol stack 
implementation. The
<a href="http://www.dmitry-kazakov.de/ada/components.htm#GNAT.Sockets.Connection_State_Machine.ELV_MAX_Cube_Client">
stack</a> is distributed under the
<a href="https://en.wikipedia.org/wiki/GNAT_Modified_General_Public_License">GM 
GPL license</a> and is free to use independently on this application.</p> <HR>
<P align="right">
<A name="1"></A><a href="#9">
<IMG src="index.gif" alt="[TOC]" width="29"
    height="29"></a><A href="#2"><IMG src="next.gif" alt="[Next]" width="29"
    height="29"></A><H2>1. Use</H2>
<P>When the application starts is scans the local area network (LAN) for 
connected MAX! cubes. Once a cube is found the radio network topology is shown 
on the overview pane.<H3>1.1. <a name="1.1"></a>Overview pane</H3>
<blockquote>
	<P>&nbsp;<img border="0" src="overview-screen-shot.png" alt="overview"></blockquote>
<p>Depending on the LAN configuration it could be impossible to find the cube. 
In that case the address of a MAX! cube can be entered manually after pressing 
the button <img border="0" src="add-cube.png" width="16" height="16" alt="add cube">. Note the 
bar near the cube address. It indicates the amount of <span class="st">868
</span>MHz radio traffic used 
by the cube. The traffic is limited. When the limit is exhausted the cube stops 
transmitting commands controlling the thermostats. The limit is reset each hour. 
Other participants, e.g. the thermostats, will continue sending their data back 
to the cube.</p>
<p>The second column contains the measured temperature. The third column contains 
the set temperature. The measured temperature is not always known. The rightmost 
column contains the time stamp of the latest known temperature as reported by 
the device. For forcing measured temperature reports from the thermostat using 
see <a href="#temperature_scanning">scanning temperatures</a> below.</p>
<p>The device state pictograms indicated right of the battery charge status have the following meaning:</p>
<blockquote>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" align="right">
	<img border="0" src="image_link.png" width="16" height="16" alt="link"></TD>
    <TD valign="top"> The device is operating properly</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">
	<img border="0" src="image_no_link.png" width="16" height="16" alt="no link"></TD>
    <TD valign="top"> The device has a link error. The devices in the same room are linked 
	to each other. For example, when a shutter contact is open 
	it turns all radiator thermostats linked to it into the airing mode. When a device has a link 
	error it cannot properly respond to or control other devices. Usually this 
	is a result of some configuration problem. Fixing it may require deleting 
	the device and pairing it again</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">
	<img border="0" src="image_error_link.png" width="16" height="16" alt="error link"></TD>
    <TD valign="top"> The device is in an error state</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">
	<img border="0" src="image_error_no_link.png" width="16" height="16" alt="error no link"></TD>
    <TD valign="top"> The device is in an error state and has a link error</TD>
  </TR>
  </TABLE>

</blockquote>
<p>&nbsp;When at least one thermostat is selected its operating mode can be changed in the combo 
box:</p>
<blockquote>
	<p><img border="0" src="thermostat-mode.png" alt="thermostat mode"></p>
</blockquote>
<p>Additional parameters like vacation end time and set temperature appear. The 
mode is changed by pressing the <i>mode set</i> button
<img border="0" src="thermostat-mode-set.png" width="18" height="16" alt="set thermostat mode">. Note that the cube performs mode change asynchronously. It could take a 
considerable time before the thermostat reacts to a mode change. While doing that 
the cube continues to report the previous operation mode. When the thermostat 
ultimately changes the mode and the cube becomes aware of that, the actual mode 
gets reflected on the overview panel.</p>
<p>For the wall mounted thermostat you can additionally set its display to indicate 
either the measured or set (current scheduled) temperature. Like mode settings 
the operation is performed asynchronously. There is no indication of the current 
mode. In order to control the effect you must inspect the corresponding wall 
thermostat and compare the indicated value with the values on the overview pane.</p>
<p>It is possible to select more than one thermostat in order to set them all. 
In particular, to select all thermostats of a cube or in a room, click on the 
corresponding row using the right mouse button:</p>
<blockquote>
	<p><img border="0" src="max-cube-popup_menu.png"></p>
</blockquote>
<p>and choose <i>select thermostats</i>.</p>
<p>If you use some thermostat settings frequently, you can define a
<a href="#shortcut_button">shortcut button</a> for the purpose. The shortcut 
button thermostat settings are kept in the configuration and need not to be same 
for all thermostats.</p>
<H3>1.2. <a name="1.2"></a>Thermostat settings pane</H3>
<p>The thermostat settings and time schedule is shown when the <i>configure device</i> button
<img border="0" src="thermostat-schedule-set.png" width="16" height="16" alt="set thermostat schedule"> is 
clicked:</p>
<blockquote>
	<p><img border="0" src="thermostat-schedule.png" alt="thermostat schedule"></p>
</blockquote>
<p>For each week day you can define thermostat temperatures, maximum up to 13 points 
per day. Each point defines the temperature and the time until the thermostat 
must keep that temperature. The last point is held to the end of the day. The time resolution is 5 minutes. The temperature resolution is 5 
Centigrade.</p>
<p>The day schedule points are automatically sorted according to the time 
column. If you have to insert a new point enter it into any unused row. Multiple points 
can be copied. The whole week schedule can be taken from another thermostat when 
the <i>copy from</i> button
<img border="0" src="thermostat-schedule-copy.png" width="16" height="17" alt="copy thermostat schedule"> is pressed:</p>
<blockquote>
	<p><img border="0" src="thermostat-select.png" width="388" height="209" alt="select thermostat"></p>
</blockquote>
<p>A week thermostat schedule can be written into and read from a file. The file 
format is portable across supported operating systems.</p>
<H3>1.3. <a name="1.3"></a>Trace pane</H3>
<p>The trace pane indicated the exchange with the cube and other network parties 
(e.g. SMTP server):</p>
<blockquote>
	<p><img border="0" src="max-cube-trace.png" alt="trace"></p>
</blockquote>
<p>Tracing can be additionally directed to a file. Buttons clear/stop/start 
control only tracing into the pane. Tracing into the file, when enabled, 
continues uninterrupted. When the checkbox append is checked the trace file is 
appended upon application start. Otherwise, the file is overwritten.</p>
<H3>1.4. <a name="1.4"></a>Graphs and monitor panes</H3>
<p>The graphs page contains one pane per room. A room's pane has stacked 
oscilloscopes one per thermostat indicating the measured room temperature (red), 
the valve position (yellow) if the thermostat is a radiator thermostat. The gray 
curve is the set temperature plus thermostat offset, the value used by control 
the heater. Adding the offset can be disabled on the settings pane.</p>
<blockquote>
	<p><img border="0" src="thermostat-graphs.png" width="758" height="626" alt="graphs"></p>
</blockquote>
<p>The temperature scaling is automatic by default. It can be set to fixed on 
the settings pane.</p>
<p>The monitor pane shows the overview of rooms heating. It has a graph per each 
room stacked upon each other. If the room has a wall-mounted thermostat then the 
temperature reported by the thermostat is shown (red and other colors). If there is no 
wall-mounted thermostats in the room then temperatures of radiator thermostats 
are shown instead. The averaged position of radiator thermostat valves is shown 
yellow.</p>
<blockquote>
	<p><img border="0" src="rooms-heating-monitor.png" width="789" height="705"></p>
</blockquote>
<H3>1.5. <a name="1.5"></a>Scanning temperatures measured by radiator thermostat</H3>
<p><a name="temperature_scanning"></a>The application deploys a technique forcing radiator thermostats to report 
measured temperatures. A radiator thermostat installed in the room managed by a 
wall-mounted thermostat reports the temperature measured by the wall-mounted 
thermostat instead of its own temperature. When installed in an unmanaged room with no 
wall-mounted thermostats a radiator thermostat reports its own measured temperature but only when either 
its valve position is changed or its operating mode is. For such &quot;unmanaged&quot; 
thermostats the application temporarily alters the thermostat mode from <i>
automatic</i> to <i>manual</i> or conversely, when there no recent measured 
temperature known. As soon as the thermostat refreshes the measured temperature 
it is switched back to the original mode. </p>
<p>The following parameters on the <i>settings</i> page control this scanning 
behavior:</p>
<ul>
	<li>The check box turning scanning altogether on or off;</li>
	<li><i>Temperature timeout</i> is the time after which the measured 
	temperature is considered obsolete. Nothing is done until that;</li>
	<li><i>Scan period</i> specifies when the application should try to force a 
	thermostat to report measured temperature after the last attempt has failed 
	for whatever reason;</li>
	<li><i>Scan timeout</i> is the time the application waits for a measured 
	temperature reported when a thermostat is in an alternate mode. The 
	thermostat is returned back to the original mode when either the measured 
	temperature is obtained or else the <i>scan timeout</i> expires. This 
	parameter value should not be greater than a half of <i>scan period</i>. The 
	thermostat is returned back to the original mode when half of <i>scan period</i> 
	is expired regardless of <i>scan timeout</i>.</li>
</ul>
<H3>1.6. <a name="1.6"></a>Cube discovery</H3>
<p>The application's setting pane controls the method cubes are discovered and 
connected.</p>
<ul>
	<li>If <i>LAN discovery</i> is enabled, the application ties to find cubes 
	to connect. When the <i>host address</i> is empty, the application scans all 
	available network interfaces (adapters) for cubes connected. Note that 
	discovery is limited by the segment. Cubes behind routers cannot be found. 
	The <i>host address</i> (or name) can be specified to limit discovery to a 
	concrete LAN segment. This address or name must one of the host where the 
	application is running, i.e. the address of a network interface (adapter).</li>
	<li>If <i>LAN discovery</i> is disabled the application does not scan the 
	network. When the <i>cube address</i> is empty, nothing else is done. The 
	cube can be connected later manually. When the <i>cube address</i> (or name) 
	is specified the application tries to connect to the cube upon start. This 
	method can be used when the cube is not connected to the local segment. Such 
	cubes cannot be discovered but still can be connected to. The field can be a 
	space, comma or semicolon separated list of addresses for the case when 
	there is more than one cube.</li>
</ul>
<H3>1.7. <a name="1.7"></a>Saving and restoring thermostat configurations</H3>
<p>When a cube is selected rooms, devices and configurations of all its radiator thermostats can be 
stored into and restored from a file. Use the button shown on the figure below 
in order to backup the actual configuration:</p>
<blockquote>
	<p>
	<img border="0" src="max-cube-save-configuration.png" alt="save configuration"></p>
</blockquote>
<p>The items saved are:</p>
<ul>
	<li>Topology (rooms and devices)</li>
	<li>Schedule (temperature program)</li>
	<li>Thermostat parameters (temperatures)</li>
	<li>Thermostat's valve parameters</li>
</ul>
<p>In order to restore a stored configuration, select a cube and press the 
button shown below:</p>
<blockquote>
	<p>
	<img border="0" src="max-cube-restore-configuration.png" width="799" height="155" alt="restore configuration"></p>
</blockquote>
<p>You will be prompted to select the configuration file. Upon successful file 
selection the restoring configuration pane is shown:</p>
<blockquote>
	<p>
	<img border="0" src="max-cube-restore-topology.png" alt="restore topology"></p>
</blockquote>
<p>It has two tabs on the right. The tab shown on the figure above is used to 
restore the cube topology. The topology describes rooms and devices. The 
configuration read from the file is matched against the actual cube topology. 
The topology from the file is shown on the pane. There 
you see the rooms and devices on the left and the actions required to restore it 
on the right. The check boxes allow masking undesired actions. Press the button
<img border="0" src="max-cube-restore-start.png" width="16" height="16" alt="start restoring"> in 
order to start restoring the topology. When a device is missing a
<a href="#pairing">pairing dialog</a> will appear in order to add the device. 
The dialog will indicate the address, name and the room of the missing device.</p>
<p>The lower tab on the right is used to restore the configuration of the 
thermostats:</p>
<blockquote>
	<p>
	<img border="0" src="thermostat-restore.png" alt="restore thermostat"></p>
</blockquote>
<p>Upon reading the file application tries to match addresses or names of the 
saved thermostats with the addresses and names of existing thermostats. The 
match is shown in the column <i>get from</i>. This column contains combo-boxes 
where another source thermostat or no thermostat can be selected. When no 
thermostat address is selected in the combo box, the existing thermostat's 
configuration is preserved. Additionally the items to restore can be selected 
in the check boxes below.</p>
<p><u><b>Notices</b></u></p>
<ol>
	<li>If you have problem with a cube losing its configuration, note that this 
	does not influence the devices. They will keep their configurations. Thus 
	once you have restored the topology there is no need to restore device 
	configurations.</li>
	<li>On the other hand, if you have a defect thermostat you want to replace. 
	Then you can use the saved configuration of the old thermostat to configure 
	the new one. Use the combo box in the column <i>get from</i> as described 
	above.</li>
	<li>Restoring configurations of many thermostats requires much of radio 
	traffic. When the traffic limit is exhausted the cube stops accepting 
	further commands. The bar at the cube address will show 100% and an 
	exclamation sign will appear. After that an hour is required to wait until 
	restoring can be continued. Successfully restored thermostat configurations 
	are skipped. The <i>retry</i> button starts failed configuration over again.</li>
</ol>
<H3>1.8. <a name="1.8"></a>Pairing devices and creating rooms</H3>
<p><a name="pairing"></a>In order to use devices with a cube they must be paired with it. To start 
pairing select a cube in the list and press the button
<img border="0" src="max-cube-pair_button.png" alt="pair button">:</p>
<blockquote>
	<p>
	<img border="0" src="max-cube-begin-pairing.png" width="799" height="155" alt="begin pairing"></p>
</blockquote>
<p>This will bring the pairing 
dialog up:</p>
<blockquote>
	<p><img border="0" src="max-cube-pairing.png" alt="pairing"></p>
</blockquote>
<p>The dialog shows detected devices and the progress bar indicating when the 
cube will leave the pairing mode. To be found a device must be also in the 
pairing mode. Usually pairing of a device is activated by pressing a certain button 
for a few seconds. Please, refer to the device documentation. Multiple 
devices can be paired at once and brought in the same room. When the cube leaves 
pairing mode, discovered devices can be either added or discarded. You can also repeat 
pairing to find other devices in the room. The cube will leave the pairing mode 
when the progress bar runs full. You can also stop it prematurely by pressing 
the <i>Stop</i> button.</p>
<blockquote>
	<p><img border="0" src="max-cube-add-device.png" alt="add device"></p>
</blockquote>
<p>The names of discovered devices as set in the <i>Name</i> edit field. The room for 
the devices is selected from the list box at the bottom of the dialog. When it 
must be a new room, the room name is entered into the <i>Room</i> edit field. 
Note that an eco switch button is placed outside any rooms.</p>
<p>When found devices are rejected they are deleted from the cube. It is can be 
a lengthy process that could potentially take several minutes. Eventually the 
cube will drop these devices and you will be able to pair them again.</p>
<H3>1.9. <a name="1.9"></a>Deleting devices and rooms</H3>
<p>In order to delete a device or a room, select it and then press the delete 
button:</p>
<blockquote>
	<p>
	<img border="0" src="max-cube-delete-device.png" width="799" height="197" alt="delete device"></p>
</blockquote>
<p>When a room is deleted all devices 
in the room are deleted as well. Deleting a device does not influence its 
settings. E.g. the schedule and valve parameters of a thermostat are kept 
intact.</p>
<p>Deleting a device could take up to several minutes. 
During that the deleted devices become <i>orphaned</i>. The cube considers them 
paired. Until they are finally disconnected they cannot be paired again. If 
there are orphaned devices the symbol and button
<img border="0" src="image_faulty_devices.png" width="16" height="16" alt="faulty devices"> is shown. 
When pressed it brings up a dialog with the list of orphaned and faulty devices. 
Faulty devices from the list can be deleted. The time required to delete a 
device can be reduced using the following method. Start pairing pressing
<img border="0" src="max-cube-pair_button.png" alt="pair button"> button. Then bring the device 
being deleted into the pairing mode:</p>
<blockquote>
	<p><img border="0" src="image_pairing.png" alt="pairing"></p>
</blockquote>
<p>Wait a few seconds and cancel pairing. Now the device must disappear from the list of orphaned devices.</p>
<H3>1.10. <a name="1.10"></a>Resetting the cube</H3>
<p>In order to delete all rooms and all devices of a cube select the cube and 
then press the button reset:</p>
<blockquote>
	<p><img border="0" src="max-cube-reset.png" width="799" height="170" alt="reset"></p>
</blockquote>
<p>After this you will have to pair all devices and 
create all rooms new. Note that the device settings are retained as they are 
kept outside the cube.</p>
<H3>1.11. <a name="1.11"></a>Interaction with the ELV MAX! software</H3>
<p>The MAX! home automation understands changes to the cube made by the ELV MAX! 
software. If you add, configure, remove devices using ELV MAX! software the 
changes will be automatically accommodated by MAX! home automation. The reverse is not true. 
Changes made in MAX! home automation may disrupt functioning ELV MAX! software. 
If you plan to continue using ELV MAX! software you can make it aware of the 
changes by pressing the button
<img border="0" src="image_max_max.png" alt="max">. This will back up the current ELV MAX! 
settings and write the ones corresponding to the actual state.</p>
<H3>1.12. <a name="1.12"></a>Preset buttons</H3>
<p><a name="shortcut_button"></a>The settings pane used to set up the shortcut 
buttons is shown below:</p>
<blockquote>
	<p><img border="0" src="max-cube-shortcuts.png"></p>
</blockquote>
<p>Each column corresponds to a button. The button when 
pressed switches the selected thermostats into the specified modes. The 
thermostat mode can be one of:</p>
<ul>
	<li><i>Automatic</i>;</li>
	<li><i>Automatic+</i> with a temperature specified. The temperature replaces 
	the current scheduled temperature until the next time interval in the 
	schedule;</li>
	<li><i>Manual</i> using the specified temperature;</li>
	<li><i>Vacation</i> using the specified temperature and duration in hours. 
	During the specified duration the thermostat holds the specified 
	temperature. After that it switches back to the mode prior to the vacation 
	mode;</li>
	<li><i>Boost</i>. In the boost mode the thermostat opens the valve for 5 
	minutes. Then it returns to the previous mode;</li>
	<li><i>Eco</i>, same as the manual mode with the eco-temperature set;</li>
	<li><i>Comfort</i>, same as the manual mode with the comfort temperature;</li>
	<li><i>Airing</i>, same as the manual mode with the airing temperature.</li>
</ul>
<p>When at least one thermostat in the column is configured, the button 
corresponding appears on the main pane. The button name can be changed in the 
row at the bottom of the pane.</p>
<hr><p align="right">
  <A name="2"></A><a href="#1">
	<IMG src="prev.gif" alt="[Back]" width="29" height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#3"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>2. HTTP automation (REST API)</H2>
<p>The application has an integrated HTTP server than can be used to control the 
connected cubes. The server is disabled by default. It can be enabled through 
the <i>settings</i> pane. The HTTP server port can be set to a value different 
from the standard 80, when it is already used. The server supports the HTTP GET requests described below:</p>
<H3>2.1. <a name="2.1"></a>Querying a device status</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-status?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font></tt></p>
</blockquote>
<p>Here <tt><font color="#FF0000">&lt;max-home-automation&gt;</font></tt> is the 
name or IP-address of the server. <tt><font color="#FF0000">&lt;address&gt;</font></tt> 
is the RF address (hexadecimal) of the cube and the device correspondingly. For 
example, assuming accessing the server at the localhost:</p>
<blockquote>
	<p><tt>http://127.0.0.1/get-status?cube=0BB8F0&amp;device=10A40C</tt></p>
</blockquote>
<p>The server response describes the current device status in textual format. 
Its components depend on the device type. When device address is absent the 
response lists statuses of all devices controlled by the cube. Individual parts 
of the status can be queried by the following queries:</p>
<blockquote>
	<p><tt><a name="get-status-json"></a>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-status-json?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font></tt></p>
</blockquote>
<p>This query is analogous to get-status except that it reports the status of a 
device or of all available devices in the JSON parser format.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-status-csv?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font></tt></p>
</blockquote>
<p>This query is analogous to get-status except that it reports the status of a 
device or of all available devices in the CSV format. The output contains one 
line for each device. The line has the following fields separated by semicolon, 
all fields except the last one are numeric:</p>
<blockquote>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080" align="right"><font color="#FFFFFF"><b>
	No.</b></font></TD>
    <TD bgcolor="#008080"> <font color="#FFFFFF"><b>Value</b></font></TD>
    <TD bgcolor="#008080"> <font color="#FFFFFF"><b>Values</b></font></TD>
  </TR>
  <TR>
    <TD valign="top" align="right">1</TD>
    <TD valign="top"> The device type</TD>
    <TD> 

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Device</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Value</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">cube </TD>
    <TD align="center"> 0</TD>
  </TR>
  <TR>
    <TD valign="top">radiator thermostat</TD>
    <TD align="center"> 1</TD>
  </TR>
  <tr>
    <TD valign="top">radiator thermostat plus</TD>
    <TD align="center"> 2</TD>
  </tr>
	<tr>
    <TD valign="top">wall thermostat</TD>
    <TD align="center"> 3</TD>
  </tr>
	<tr>
    <TD valign="top">shutter contact</TD>
    <TD align="center"> 4</TD>
  </tr>
	<tr>
    <TD valign="top">eco button</TD>
    <TD align="center"> 5</TD>
  </tr>
	<tr>
    <TD valign="top">unknown</TD>
    <TD align="center"> 6</TD>
  </tr>
	</TABLE>

	</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">2</TD>
    <TD valign="top"> The device RF address, hexadecimal</TD>
    <TD> 000000..FFFFFF</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">3</TD>
    <TD valign="top"> The device error</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">4</TD>
    <TD valign="top"> Device initialized</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">5</TD>
    <TD valign="top"> Battery low</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">6</TD>
    <TD valign="top"> Error</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">7</TD>
    <TD valign="top"> Panel locked</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">8</TD>
    <TD valign="top"> Gateway known</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">9</TD>
    <TD valign="top"> Day saving time</TD>
    <TD> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">10</TD>
    <TD valign="top"> Mode</TD>
    <TD> 

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Mode</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Value</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">automatic</TD>
    <TD align="center"> 0</TD>
  </TR>
  <TR>
    <TD valign="top">manual</TD>
    <TD align="center"> 1</TD>
  </TR>
  <tr>
    <TD valign="top">boost</TD>
    <TD align="center"> 2</TD>
  </tr>
	<tr>
    <TD valign="top">vacation</TD>
    <TD align="center"> 3</TD>
  </tr>
	</TABLE>

	</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">11</TD>
    <TD valign="top"> Set temperature</TD>
    <TD> &nbsp;</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">12</TD>
    <TD valign="top"> New temperature</TD>
    <TD> &nbsp;</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">13</TD>
    <TD valign="top"> Valve position</TD>
    <TD> 0..100</TD>
  </TR>
  <TR>
    <TD valign="top" align="right">14</TD>
    <TD valign="top"> Actual temperature</TD>
    <TD> 0 if not known</TD>
  </TR>
  <tr>
    <TD valign="top" align="right">15 </TD>
    <TD valign="top"> Open (shutter contact)</TD>
    <TD> 0..1</TD>
  </tr>
  <tr>
    <TD valign="top" align="right">16 </TD>
    <TD valign="top"> Offset (thermostat)</TD>
    <TD> &nbsp;</TD>
  </tr>
  <tr>
    <TD valign="top" align="right">17 </TD>
    <TD valign="top"> Serial number</TD>
    <TD> KEQ0828854</TD>
  </tr>
  <TR>
    <TD valign="top" align="right">18 </TD>
    <TD valign="top"> Device name</TD>
    <TD> Thermostat 1</TD>
  </TR>
  </TABLE>

	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-battery?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current battery level of a device. The 
returned value is <i>high</i> or <i>low</i>.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-cubes-list</tt></p>
</blockquote>
<p>This query is responded with the list of RF addresses of the known cubes 
separated by spaces.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-cubes-json-list</tt></p>
</blockquote>
<p>This query is responded with the list of RF addresses of the known cubes 
in JSON format.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-duty?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current value of the cube's duty cycle in 
percent. When the value reaches 100% the cube stops using its radio frequency 
for an hour.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-link?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the radio link of a device. The returned value 
is <i>error</i> or <i>ok</i>.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-mode?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current mode of a thermostat. The returned 
values are <i>automatic</i>, <i>manual</i>, <i>boots</i>, <i>vacation</i>.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-rooms-list?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the list of rooms per line. For each room the 
corresponding line of the response contains the list of space separated RF-addresses 
of the devices in&nbsp; the room, followed by the room ID and name. The room ID 
is introduced by dash (#), the name is by minus (-). For example:</p>
<blockquote>
	<pre>0B76D4 0CB6E2 #1 - Small room on the left
0B7E19 0C9809 0CB7FF #2 - Bedroom
0B76DA 0C9E44 0CB003 17EE29 #3 - Recreation room
0C8EA2 0CA489 0CB6D6 10A40C #4 - Big room on the right
050F6D 12F4E0 #5 - Bathroom</pre>
</blockquote>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-rooms-json-list?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the list of rooms in JSON format. For each room 
the response contains the room name, the room ID and the list of RF-addresses of 
the devices in&nbsp; the room.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-temperature?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current temperature measured by a 
wall-mounted thermostat in Centigrade.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-set-temperature?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current set temperature of a thermostat in 
Centigrade.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-summer-time?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the device summer time settings. The returned 
value is <i>yes</i> or <i>no</i>.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-valve?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the current valve position of a radiator 
thermostat 0-100%. The value 100% corresponds to the fully opened valve.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-valve-average?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the average valve position of radiator 
thermostats handled by the cube.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-valve-min?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the minimum valve position of all radiator 
thermostats handled by the cube.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-valve-max?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query is responded with the maximum valve position of all radiator 
thermostats handled by the cube.</p>
<H3>2.2. <a name="2.2"></a>Setting thermostats into automatic mode</H3>
<blockquote>
	<tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-automatic?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font></tt></blockquote>
<p>or</p>
<blockquote>
	<tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-automatic?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font>&amp;<font color="#FF0000">{</font>temperature<font color="#FF0000">[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]</font>=<font color="#FF0000">&lt;value&gt;|</font>airing<font color="#FF0000">|</font>comfort<font color="#FF0000">|</font>eco<font color="#FF0000">}</font></tt></blockquote>
<p>For example:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-automatic?cube=0BB8F0&amp;device=10A40C</tt></p>
</blockquote>
<p>The temperature is specified by the parameter <tt><font color="#FF0000">&lt;value&gt;</font></tt>. 
It can be a relative or absolute value. For example an absolute temperature 
specification:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-automatic?cube=0BB8F0&amp;device=10A40C&amp;temperature=18.5</tt></p>
</blockquote>
<p>Here the thermostat 10A40C is set to keep 18.5 Centigrade until the next time 
interval, when it returns to the schedule. The following is a 
example of setting the temperature relative to the current one:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-automatic?cube=0BB8F0&amp;device=10A40C&amp;temperature+=0.5</tt></p>
</blockquote>
<p>In this example&nbsp; the temperature is incremented by 0.5 Centigrade.</p>

<p>Additionally one of the following keywords can be used for the temperature:</p>
<ul>
	<li><i>airing</i> is the temperature from the thermostat's settings used in 
	the airing mode, i.e. when one of the windows associated with the thermostat 
	is open;</li>
	<li><i>comfort</i> is the comfort temperature from from the thermostat 
	settings;</li>
	<li><i>eco</i> is the eco temperature from the thermostat's settings.</li>
</ul>
<p>The following request sets airing temperature:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-automatic?cube=0BB8F0&amp;device=10A40C&amp;airing</tt></p>
</blockquote>
<p>The field <tt>device=<font color="#FF0000">&lt;address&gt;</font></tt> can be 
omitted. In this case the command applies to all thermostats, e.g.</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-automatic?cube=0BB8F0&amp;eco</tt></p>
</blockquote>
<p>Here all thermostats set to the corresponding <i>eco</i> temperature (until 
the next time slice in the schedule).</p>
<H3>2.3. <a name="2.3"></a>Setting thermostats into boost mode</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-boost?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font></tt></p>
</blockquote>
<p>For example:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-boost?cube=0BB8F0&amp;device=10A40C</tt></p>
</blockquote>
<H3>2.4. <a name="2.4"></a>Setting thermostats into manual mode</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-manual?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font>&amp;<font color="#FF0000">{</font>temperature<font color="#FF0000">[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]</font>=<font color="#FF0000">&lt;value&gt;|</font>airing<font color="#FF0000">|</font>comfort<font color="#FF0000">|</font>eco<font color="#FF0000">}</font></tt></p>
</blockquote>
<p>The temperature is specified by the parameter <tt><font color="#FF0000">&lt;value&gt;</font></tt>. 
It can be a relative or absolute value. For example an absolute temperature 
specification:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-manual?cube=0BB8F0&amp;device=10A40C&amp;temperature=18.5</tt></p>
</blockquote>
<p>Here the thermostat 10A40C is set to keep 18.5 Centigrade. The following is a 
example of setting the temperature relative to the current one:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-manual?cube=0BB8F0&amp;device=10A40C&amp;temperature+=0.5</tt></p>
</blockquote>
<p>In this example&nbsp;the temperature is incremented by 0.5 Centigrade.</p>
<H3>2.5. <a name="2.5"></a>Setting thermostats into vacation mode</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-vacation?cube=<font color="#FF0000">&lt;address&gt;[</font>&amp;device=<font color="#FF0000">&lt;address&gt;]</font>&amp;<font color="#FF0000">{</font>temperature<font color="#FF0000">[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]</font>=<font color="#FF0000">&lt;value&gt;|</font>airing<font color="#FF0000">|</font>comfort<font color="#FF0000">|</font>eco<font color="#FF0000">}</font>&amp;<font color="#FF0000">{</font>weeks<font color="#FF0000">|</font>days<font color="#FF0000">|</font>hours<font color="#FF0000">|</font>minutes<font color="#FF0000">}</font>=<font color="#FF0000">&lt;count&gt;</font></tt></p>
</blockquote>
<p>For the vacation mode again the temperature can be specified relative or 
absolute. The vacation end time is given as a number <tt><font color="#FF0000">&lt;count&gt;</font></tt> 
of weeks, days, hours or minutes. For example:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-vacation?cube=0BB8F0&amp;device=10A40C&amp;temperature=16&amp;days=2</tt></p>
</blockquote>
<p>Here the thermostat 10A40C is set to keep 16 Centigrade for two days. After 
that it will switch back into its previous mode.</p>
<H3>2.6. <a name="2.6"></a>Setting thermostat's schedule</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-schedule?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font>&amp;schedule=<font color="#FF0000">&lt;week-schedule&gt;</font></tt></p>
</blockquote>
<p><a name="thermostat-schedule-syntax"></a>The thermostat schedule in the 
following format (using Bacus-Naur forms):</p>
<blockquote>
	<table border="0">
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;week-schedule&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;sub-schedule&gt;[</font>,<font color="#FF0000">&lt;week-schedule&gt;]</font></tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;sub-schedule&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;days-range&gt;</font>(<font color="#FF0000">&lt;day-schedule&gt;</font>)</tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;days-range&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;week-day&gt;|&lt;week-day&gt;</font>..<font color="#FF0000">&lt;week-day&gt;</font></tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;week-day&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt>Mo<font color="#FF0000">|</font>Tu<font color="#FF0000">|</font>We<font color="#FF0000">|</font>Th<font color="#FF0000">|</font>Fr<font color="#FF0000">|</font>Sa<font color="#FF0000">|</font>Su</tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;day-schedule&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;temperature-point&gt;[</font>,<font color="#FF0000">day-schedule&gt;]</font></tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;temperature-point&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;time&gt;</font>=<font color="#FF0000">&lt;temperature&gt;</font></tt></td>
		</tr>
		<tr>
			<td align="right"><tt><font color="#FF0000">&lt;time&gt;</font></tt></td>
			<td><tt><font color="#FF0000">::=</font></tt></td>
			<td><tt><font color="#FF0000">&lt;hour&gt;[</font>:<font color="#FF0000">&lt;minute&gt;]</font></tt></td>
		</tr>
	</table>
</blockquote>
<p>Blank characters including LF and CR may appear between the elements. The 
value of <tt><font color="#FF0000">&lt;time&gt;</font></tt> specifies the end time 
until the given temperature is to be held by the thermostat. The times must be specified in 
an ascending 
order. No more than 13 points are allowed per <tt><font color="#FF0000">
&lt;day-schedule&gt;</font></tt>. Week days and their ranges can appear in any 
order. They are case-insensitive. All days of the week must be covered. Here is 
an example of a schedule:</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-schedule?cube=0BB8F0&amp;device=10A40C&amp;schedule=Mo(17:00=20,18:30=21.5),Tu..Su(09:00=19.0,10:10=21.0,18:30=19.5)</tt></p>
</blockquote>
<H3>2.7. <a name="2.7"></a>Controlling cube connection</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/disconnect?cube=<font color="#FF0000">&lt;address&gt;<br>
	</font>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/reconnect?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>A cube can be disconnected and reconnected again using these two queries.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/get-connection?cube=<font color="#FF0000">&lt;address&gt;</font></tt></p>
</blockquote>
<p>This query returns <i>connected</i> or <i>disconnected</i> depending of the 
cube connection status.</p>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/reboot?serial=<font color="#FF0000">&lt;serial-no&gt;</font></tt></p>
</blockquote>
<p>The cube is identified by its 10 characters long serial number, e.g. KEQ0828854.</p>
<H3>2.8. <a name="2.8"></a>Setting thermostat parameters</H3>
<blockquote>
	<p><tt>http://<font color="#FF0000">&lt;max-home-automation&gt;</font>/set-eco-temperature?cube=<font color="#FF0000">&lt;address&gt;</font>&amp;device=<font color="#FF0000">&lt;address&gt;</font>&amp;temperature=<font color="#FF0000">&lt;value&gt;</font></tt></p>
</blockquote>
<p>This request sets the eco temperature.</p>
<blockquote>
	<p><tt>http://127.0.0.1/set-eco-temperature?cube=0BB8F0&amp;device=10A40C&amp;temperature=16.5</tt></p>
</blockquote>
<p>In this example the eco temperature is set to 16.5 Centigrade.</p>
<H3>2.9. <a name="2.9"></a>Custom web page</H3>
<p>Apart from the REST API described above, the integrated HTTP server supports custom web pages. 
A custom web page can be 
specified on the settings pane as UI HTTP page:</p>
<blockquote>
	<p><img border="0" src="max-cube-settings.png"></p>
</blockquote>
<p>This feature can be used to design a custom user interface, e.g. a dashboard. 
The path to the file must refer a file that exists during run-time. The file may 
refer to other files (e.g. jpeg pictures etc) which also must exist in order to 
show the page properly. These files are not cached and always opened new at each 
HTTP client request.</p>
<p>There exist a great variety of tools and libraries for designing web-based dashboards. 
Any of them can be used, provided it would not require a special backend, e.g. a 
special HTTP server, database etc. Also it might be important to choose a 
self-contained tool that allows holding locally all files necessary for the page 
to function. Otherwise the dashboard will not work without internet access. For 
example, the sample dashboard represented below refers to an external site where 
the trial version of the widget library is hosted.</p>
<p>The 
following sample code represents a simple dashboard designed using
<a href="https://www.fusioncharts.com">FusionCharts</a> library:</p>
<blockquote>
	<p><img border="0" src="max-cube-dashboard.png"></p>
</blockquote>
<p>Here is the source code of the corresponding HTTP page (it deploys 
JavaScript):</p>File <EM>dashboard.html</EM>:
<TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt>

<font color="#0000FF">&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp; &lt;title&gt;</font>Dashboard sample<font color="#0000FF">&lt;/title&gt;<br>
&nbsp;&nbsp; &lt;script type</font>=&quot;<font color="#FF0000">text/javascript</font>&quot;
<font color="#0000FF">src</font>=&quot;<font color="#FF0000">https://cdn.fusioncharts.com/fusioncharts/latest/fusioncharts.js</font>&quot;<font color="#0000FF">&gt;&lt;/script&gt;</font><br>
&nbsp;&nbsp; <font color="#0000FF">&lt;script type</font>=&quot;<font color="#FF0000">text/javascript</font>&quot;
<font color="#0000FF">src</font>=&quot;<font color="#FF0000">https://cdn.fusioncharts.com/fusioncharts/latest/themes/fusioncharts.theme.fusion.js</font>&quot;<font color="#0000FF">&gt;&lt;/script&gt;</font><br>
&nbsp;&nbsp; <font color="#0000FF">&lt;script type</font>=&quot;<font color="#FF0000">text/javascript</font>&quot;<font color="#0000FF">&gt;</font><br>
<br>
<font color="#0000FF">var</font> HttpClient = <font color="#0000FF">function</font> 
()<br>
{<br>
&nbsp;&nbsp; this.get = <font color="#0000FF">function</font> (URL, Callback)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> Request =
<font color="#0000FF">new</font> XMLHttpRequest ();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.onreadystatechange =
<font color="#0000FF">function </font>()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">if</font> 
(Request.readyState == <font color="#800000">4</font> &amp;&amp; Request.status ==
<font color="#800000">200</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Callback (Request.responseText);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.open (&quot;<font color="#FF0000">GET</font>&quot;, 
URL, <font color="#0000FF">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.send (<font color="#0000FF">null</font>);<br>
&nbsp;&nbsp; }<br>
}<br>
<br>
<font color="#0000FF">var</font> Client = <font color="#0000FF">new</font> 
HttpClient ();<br>
<font color="#0000FF">var</font> Topology = {}; <font color="#008000">// The 
rooms map id-&gt;room data</font><br>
<font color="#0000FF">var</font> Actions&nbsp; = []; <font color="#008000">// 
The queue of actions to perform</font><br>
<font color="#0000FF">var</font> Location = <font color="#800000">0</font>;&nbsp;
<font color="#008000">// Where to place a new widget</font><br>
<br>
<font color="#0000FF">function</font> Do_Room (Cube, Room)<br>
{<br>
&nbsp;&nbsp; <font color="#0000FF">if</font> (Topology [Cube] [Room].temperature.source 
== <font color="#800000">0</font>) <font color="#0000FF">return</font>;<br>
&nbsp;&nbsp; Topology [Cube] [Room].temperature.widget =<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">new</font> FusionCharts<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (&nbsp; {&nbsp; type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
'<font color="#FF0000">thermometer</font>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; renderAt:&nbsp;&nbsp; 
Topology [Cube] [Room].location,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; width:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">240</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; height:&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">310</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataFormat: '<font color="#FF0000">json</font>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataSource:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { &quot;<font color="#FF0000">chart</font>&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&nbsp; &quot;<font color="#FF0000">caption</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Topology [Cube] [Room].name,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#008000">// &quot;subcaption&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;&quot;,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">lowerLimit</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">0</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">upperLimit</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">30</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">decimals</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">numberSuffix</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">C</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">showhovereffect</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">thmFillColor</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">#008ee4</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">showGaugeBorder</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">gaugeBorderColor</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp; &quot;<font color="#FF0000">#008ee4</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">gaugeBorderThickness</font>&quot;: <font color="#800000">2</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">gaugeBorderAlpha</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">30</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">gaugeFillColor</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">#008ee4</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">gaugeFillAlpha</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">100</font>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">thmOriginX</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">100</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">chartBottomMargin</font>&quot;:&nbsp;&nbsp;&nbsp;
<font color="#800000">20</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">valueFontColor</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">#000000</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">showValue</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800080">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">adjustTM</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">ticksOnRight</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">0</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">tickMarkDistance</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">5</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">tickValueDistance</font>&quot;:&nbsp;&nbsp;&nbsp;
<font color="#800000">2</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">majorTMNumber</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">9</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">majorTMHeight</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">12</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">minorTMNumber</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">4</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">minorTMHeight</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">7</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">tickValueStep</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">2</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">valueFontSize</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">46</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">valueFontBold</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">ValuePadding</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">35</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">valueFontColor</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">#808080</font>&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">showhovereffect</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#800000">1</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">theme</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">fusion</font>&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">value</font>&quot;: <font color="#800000">0</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br>
}<br>
<br>
<font color="#0000FF">function</font> Refresh ()<br>
{<br>
&nbsp;&nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">var</font> 
Cube <font color="#0000FF">in</font> Topology)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Client.get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (&nbsp; window.location.origin + '<font color="#FF0000">/get-status-json?cube=</font>' 
+ Cube,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">function</font> 
(Response)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State = 
JSON.parse (Response);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">for</font> (<font color="#0000FF">var</font> Device
<font color="#0000FF">in</font> State.devices)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">var</font> Address = State.devices [Device].address;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">for</font> (<font color="#0000FF">var</font> Room
<font color="#0000FF">in</font> Topology [Cube])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">if</font> (Topology [Cube] [Room].temperature.source == 
Address)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Topology [Cube] [Room].temperature.widget.feedData<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
(&nbsp; &quot;<font color="#FF0000">&amp;value=</font>&quot; + State.devices [Device].temperature<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp; }&nbsp; }&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br>
&nbsp;&nbsp; }<br>
}<br>
<br>
<font color="#0000FF">function</font> Pump ()<br>
{<br>
&nbsp;&nbsp; <font color="#0000FF">if</font> (Actions.length &gt;
<font color="#800000">0</font>)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> This = 
Actions.pop ();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This.Function (This.Cube, This.Room, This.Device);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">return</font>;<br>
&nbsp;&nbsp; }<br>
&nbsp;&nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">var</font> 
Cube <font color="#0000FF">in</font> Topology)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">var</font> 
Room <font color="#0000FF">in</font> Topology [Cube])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Do_Room (Cube, Room);<br>
&nbsp;&nbsp; }&nbsp; }<br>
&nbsp;&nbsp; FusionCharts.ready<br>
&nbsp;&nbsp; (&nbsp; <font color="#0000FF">function</font> ()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">for</font> 
(<font color="#0000FF">var</font> Cube <font color="#0000FF">in</font> Topology)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">for</font> (var Room <font color="#0000FF">in</font> 
Topology [Cube])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">if</font> (Topology [Cube] [Room].temperature.widget !=
<font color="#0000FF">null</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Topology [Cube] [Room].temperature.widget.render ();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp; }&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setInterval (Refresh,
<font color="#800000">1000</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp; );<br>
}<br>
<br>
<font color="#0000FF">function</font> On_Device_Status (Response, Cube, Room, 
Device)<br>
{<br>
<font color="#0000FF">&nbsp;&nbsp; var</font> Status = JSON.parse (Response);<br>
<br>
&nbsp;&nbsp; <font color="#0000FF">if</font> (Status.type == &quot;<font color="#FF0000">wall 
thermostat</font>&quot;)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology [Cube] [Room].temperature.source = 
Device;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology [Cube] [Room].is_wall =
<font color="#0000FF">true</font>;<br>
&nbsp;&nbsp; }<br>
&nbsp;&nbsp; <font color="#0000FF">else if</font> (Status.type == &quot;<font color="#FF0000">radiator 
thermostat</font>&quot;)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">if</font> (Topology [Cube] 
[Room].temperature.source == <font color="#800000">0</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology [Cube] [Room].temperature.source 
= Device;<br>
&nbsp;&nbsp; }&nbsp; }<br>
&nbsp;&nbsp; Pump ();<br>
}<br>
<br>
<font color="#0000FF">function</font> On_Rooms_List (Response, Cube)<br>
{<br>
&nbsp;&nbsp; <font color="#0000FF">var</font> Rooms_List = JSON.parse 
(Response);<br>
<br>
&nbsp;&nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">var</font> 
Room_No = <font color="#800000">0</font>; Room_No &lt; Rooms_List.length; Room_No++)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> Room_ID = 
Rooms_List [Room_No].id;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> At = Location;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Location++;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology [Cube] [Room_ID] =<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; &quot;<font color="#FF0000">name</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Rooms_List [Room_No].name,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;<font color="#FF0000">id</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Room_ID,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;<font color="#FF0000">location</font>&quot;:&nbsp;&nbsp;&nbsp;&nbsp; 
At.toString (<font color="#800000">10</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;<font color="#FF0000">temperature</font>&quot;:&nbsp; 
{&nbsp; &quot;<font color="#FF0000">source</font>&quot;:&nbsp; <font color="#800000">0</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">is_wall</font>&quot;: <font color="#0000FF">false</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">widget</font>&quot;:&nbsp; <font color="#0000FF">null</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">for</font> (&nbsp;
<font color="#0000FF">var</font> Device_No = <font color="#800000">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Device_No &lt; Rooms_List [Room_No].devices.length;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Device_No++<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> 
Device = Rooms_List [Room_No].devices [Device_No];<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Actions.push<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (&nbsp; {&nbsp; &quot;<font color="#FF0000">Function</font>&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">function</font> (Cube, Room, Device)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Client.get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
(&nbsp; window.location.origin&nbsp;&nbsp; +<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
'<font color="#FF0000">/get-status-json?cube=</font>' +<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Cube&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
'<font color="#FF0000">&amp;device=</font>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Device.toString (<font color="#800000">16</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">function</font> (Response)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
On_Device_Status (Response, Cube, Room, Device);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">Cube</font>&quot;:&nbsp;&nbsp; Cube,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">Room</font>&quot;:&nbsp;&nbsp; Room_ID,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;<font color="#FF0000">Device</font>&quot;: Device<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br>
&nbsp;&nbsp; }&nbsp; }<br>
&nbsp;&nbsp; Pump ();<br>
}<br>
<br>
<font color="#0000FF">function</font> On_Cubes_List (Response)<br>
{<br>
<font color="#0000FF">&nbsp;&nbsp; var</font> Cubes_List = JSON.parse 
(Response);<br>
<br>
&nbsp;&nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">var</font> 
Cube_No = <font color="#800000">0</font>; Cube_No &lt; Cubes_List.length; Cube_No++)<br>
&nbsp;&nbsp; { <font color="#008000">// Query list of rooms</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">var</font> Cube = 
Cubes_List [Cube_No].toString (<font color="#800000">16</font>);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topology [Cube] = {};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Actions.push<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (&nbsp; {&nbsp; &quot;<font color="#FF0000">Function</font>&quot; 
:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">function</font> (Cube, Room, Device)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Client.get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
(&nbsp; window.location.origin +<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
'<font color="#FF0000">/get-rooms-json-list?cube=</font>' +<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Cube.toString (<font color="#800000">16</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">function</font> (Response) { On_Rooms_List (Response, 
Cube); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;<font color="#FF0000">Cube</font>&quot; 
: Cube<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br>
&nbsp;&nbsp; }<br>
&nbsp;&nbsp; Pump ();<br>
}<br>
<br>
Client.get (window.location.origin + '<font color="#FF0000">/get-cubes-json-list</font>', 
On_Cubes_List);<br>
<br>
<font color="#0000FF">&nbsp;&nbsp; &lt;/script&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;table border</font>=&quot;<font color="#FF0000">0</font>&quot; <font color="#0000FF">
width</font>=&quot;<font color="#FF0000">100%</font><font color="#0000FF">&quot;&gt;<br>
&nbsp;&nbsp; &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">0</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">1</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">2</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp; &lt;/tr&gt;<br>
&nbsp;&nbsp; &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">3</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">4</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;div class</font>='<font color="#FF0000">chartCont</font>'
<font color="#0000FF">id</font>='<font color="#FF0000">5</font>'<font color="#0000FF">&gt;&lt;/div&gt;&lt;/td&gt;<br>
&nbsp;&nbsp; &lt;/tr&gt;<br>
&lt;/table&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;</font></tt></TD>
  </TR>
</TABLE>
<hr>
<p align="right">
  <A name="3"></A><a href="#2">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#6"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>3. MQTT automation</H2>
<p>The integrated MQTT server allows access and control of the cubes through the <b>M</b>essage <b>Q</b>ueueing <b>T</b>elemetry <b>T</b>ransport (<b>MQTT</b>). 
MQTT is an ISO standard (<a href="http://www.iso.org/iso/catalogue_detail.htm?csnumber=69466">ISO/IEC 
PRF 20922</a>) messaging protocol. By default the MQTT server is disabled. It is enabled through 
the <i>settings</i> pane.</p>
<H3>3.1. <a name="3.1"></a>Published topics</H3>
<p>The server publishes data received from the cube as retained topics:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Topic</b></font></TD>
    <TD bgcolor="#008080"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/connection</tt></TD>
    <TD> <i>on</i>, <i>off</i></TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/duty</tt></TD>
    <TD> 0.1</TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/eco 
	button/<font color="#FF0000">&lt;device-address&gt;</font>/battery</tt></TD>
    <TD> <i>low</i>, <i>high</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/eco 
	button/<font color="#FF0000">&lt;device-address&gt;</font>/error</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/eco 
	button/<font color="#FF0000">&lt;device-address&gt;</font>/initialized</tt></TD>
    <TD> <i>ok</i>, <i>uninitialized</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/eco 
	button/<font color="#FF0000">&lt;device-address&gt;</font>/link</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/eco 
	button/<font color="#FF0000">&lt;device-address&gt;</font>/panel locked</tt></TD>
    <TD> <i>locked</i>, <i>unlocked</i></TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/battery</tt></TD>
    <TD> <i>low</i>, <i>high</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/error</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/initialized</tt></TD>
    <TD> <i>ok</i>, <i>uninitialized</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/link</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/mode</tt></TD>
    <TD> <i>automatic</i>, <i>manual</i>, <i>boost</i>, <i>vacation</i> </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/panel locked</tt></TD>
    <TD> <i>locked</i>, <i>unlocked</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/set temperature</tt></TD>
    <TD> 19.0 </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/temperature</tt></TD>
    <TD> 19.5 </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/radiator 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/valve</tt></TD>
    <TD> 30</TD>
  </tr>
  <TR>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/battery</tt></TD>
    <TD> <i>low</i>, <i>high</i></TD>
  </TR>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/error</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/initialized</tt></TD>
    <TD> <i>ok</i>, <i>uninitialized</i></TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/link</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/panel locked</tt></TD>
    <TD> <i>locked</i>, <i>unlocked</i></TD>
  </tr>
  <TR>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/shutter 
	contact/<font color="#FF0000">&lt;device-address&gt;</font>/status</tt></TD>
    <TD> <i>open</i>, <i>close</i></TD>
  </TR>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/status/<font color="#FF0000">&lt;device-address&gt;</font>/json</tt></TD>
    <TD> the device status in JSON format, same as REST API
	<a href="#get-status-json">get-status-json</a> </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/thermostat 
	valves/average</tt></TD>
    <TD> 50</TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/thermostat 
	valves/max</tt></TD>
    <TD> 70</TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/thermostat 
	valves/min</tt></TD>
    <TD> 30</TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/battery</tt></TD>
    <TD> <i>low</i>, <i>high</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/error</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/initialized</tt></TD>
    <TD> <i>ok</i>, <i>uninitialized</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/link</tt></TD>
    <TD> <i>ok</i>, <i>error</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/mode</tt></TD>
    <TD> <i>automatic</i>, <i>manual</i>, <i>boost</i>, <i>vacation</i> </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/panel locked</tt></TD>
    <TD> <i>locked</i>, <i>unlocked</i></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/set temperature</tt></TD>
    <TD> 19.0 </TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/wall 
	thermostat/<font color="#FF0000">&lt;device-address&gt;</font>/temperature</tt></TD>
    <TD> 19.5 </TD>
  </tr>
  </TABLE>

<p>Here <tt><font color="#FF0000">&lt;cube-address&gt;</font></tt> 
is the RF address (hexadecimal) of the cube. <tt><font color="#FF0000">&lt;device-address&gt;</font></tt> 
is the RF address of the device. All topics are retained, that means a client 
may subscribe to them at any time and get the latest values of. The topic ...<i>/thermostat 
valves/average</i> contains the average valve position of all cube's radiator 
thermostats. The topics ...<i>/thermostat valves/min</i> and ...<i>/thermostat 
valves/max</i> are correspondingly the minimum and maximum valve positions among cube's radiator 
thermostats.</p>
<H3>3.2. <a name="3.2"></a>Controlling thermostats</H3>
<p>A thermostat can be controlled by publishing special topics on the server. 
The server does not propagate or retain these topics.</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Topic</b></font></TD>
    <TD bgcolor="#008080" align="left" colspan="2"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set<font color="#FF0000">[</font>/<font color="#FF0000">&lt;device-address&gt;]</font>/automatic</tt></TD>
    <TD align="left" colspan="2"> <tt><font color="#FF0000">[[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort<font color="#FF0000">]</font></tt></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set<font color="#FF0000">[</font>/<font color="#FF0000">&lt;device-address&gt;]</font>/boost</tt></TD>
    <TD align="center" colspan="2"> -</TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set/<font color="#FF0000">&lt;device-address&gt;</font>/eco</tt></TD>
    <TD align="left" colspan="2"> <tt><font color="#FF0000">&lt;temperature&gt;</font></tt></TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set<font color="#FF0000">[</font>/<font color="#FF0000">&lt;device-address&gt;]</font>/manual</tt></TD>
    <TD align="left" colspan="2"> <tt><font color="#FF0000">[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort</tt></TD>
  </tr>
  <tr>
    <TD valign="top" rowspan="5"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set<font color="#FF0000">[</font>/<font color="#FF0000">&lt;device-address&gt;]</font>/mode</tt></TD>
    <TD align="left" style="border-right-style: none; border-right-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt><font color="#FF0000">{&nbsp;&nbsp; </font></tt></TD>
    <TD align="left" style="border-left-style: none; border-left-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> <tt>
	automatic<font color="#FF0000"> [[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort<font color="#FF0000">]</font></tt></TD>
  </tr>
	<tr>
    <TD align="left" style="border-right-style: none; border-right-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt><font color="#FF0000">|</font></tt></TD>
    <TD align="left" style="border-left-style: none; border-left-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt>boost</tt></TD>
  </tr>
	<tr>
    <TD align="left" style="border-right-style: none; border-right-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt><font color="#FF0000">|</font></tt></TD>
    <TD align="left" style="border-left-style: none; border-left-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt>manual<font color="#FF0000"> {[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort<font color="#FF0000">}</font></tt></TD>
  </tr>
	<tr>
    <TD align="left" style="border-right-style: none; border-right-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt><font color="#FF0000">|</font></tt></TD>
    <TD align="left" style="border-left-style: none; border-left-width: medium; border-top-style: none; border-top-width: medium; border-bottom-style: none; border-bottom-width: medium" valign="top"> 
	<tt>vacation<font color="#FF0000"> {[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort<font color="#FF0000">} 
	&lt;count&gt;{</font>weeks<font color="#FF0000">|</font>days<font color="#FF0000">|</font>hours<font color="#FF0000">|</font>minutes<font color="#FF0000">}</font></tt></TD>
  </tr>
	<tr>
    <TD align="left" style="border-right-style: none; border-right-width: medium; border-top-style: none; border-top-width: medium" valign="top"> 
	<tt><font color="#FF0000">}</font></tt></TD>
    <TD align="left" style="border-left-style: none; border-left-width: medium; border-top-style: none; border-top-width: medium" valign="top"> &nbsp;</TD>
  </tr>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set/<font color="#FF0000">&lt;device-address&gt;</font>/schedule</tt></TD>
    <TD align="left" colspan="2"> The thermostat schedule in the format described
	<a href="#thermostat-schedule-syntax">above</a></TD>
  </tr>
  <TR>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/set<font color="#FF0000">[</font>/<font color="#FF0000">&lt;device-address&gt;]</font>/vacation</tt></TD>
    <TD align="left" colspan="2"> <tt><font color="#FF0000">{[</font>+<font color="#FF0000">|</font>-<font color="#FF0000">]&lt;temperature&gt;|</font>airing<font color="#FF0000">|</font>eco<font color="#FF0000">|</font>comfort<font color="#FF0000">} 
	&lt;count&gt;{</font>weeks<font color="#FF0000">|</font>days<font color="#FF0000">|</font>hours<font color="#FF0000">|</font>minutes<font color="#FF0000">}</font></tt></TD>
  </TR>
  </TABLE>

<p>Here <tt><font color="#FF0000">&lt;cube-address&gt;</font></tt> 
is the RF address (hexadecimal) of the cube. <tt><font color="#FF0000">&lt;device-address&gt;</font></tt> 
is the RF address of the device, which must be a thermostat. When <tt><font color="#FF0000">&lt;device-address&gt;</font></tt> 
is absent the command applies to all radiator thermostats. <tt><font color="#FF0000">
&lt;temperature&gt;</font></tt> is the temperature to set. When a sign is used the 
temperature is relative to the actual set value.<tt><font color="#FF0000"> 
&lt;count&gt;</font></tt> is the number of weeks, days, hours, minutes as specified. 
Additionally one of the following keywords can be used for the temperature:</p>
<ul>
	<li><i>airing</i> is the temperature from the thermostat's settings used in 
	the airing mode, i.e. when one of the windows associated with the thermostat 
	is open;</li>
	<li><i>comfort</i> is the comfort temperature from from the thermostat 
	settings;</li>
	<li><i>eco</i> is the eco temperature from the thermostat's settings.</li>
</ul>
<H3>3.3. <a name="3.3"></a>Controlling cube connection</H3>
<p>A cube can be disconnected and reconnecting by publishing special topics on the server. 
The server does not propagate or retain these topics.</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Topic</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
  <tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/disconnect</tt></TD>
    <TD align="center"> -</TD>
  </tr>
	<tr>
    <TD valign="top"><tt><font color="#FF0000">&lt;cube-address&gt;</font>/reconnect</tt></TD>
    <TD align="center"> -</TD>
  </tr>
	<tr>
    <TD valign="top"><tt>reboot</tt></TD>
    <TD align="center"> The cube serial number 10 characters long, e.g. 
	KEQ0821071 </TD>
  </tr>
	</TABLE>

<p>Here <tt><font color="#FF0000">&lt;cube-address&gt;</font></tt> 
is the RF address (hexadecimal) of the cube.</p>
<H3>3.4. <a name="3.4"></a>Externally published topics</H3>
<p>By default the MAX! home automation MQTT broker rejects client's attempts to 
publish any topics beyond ones to control the thermostats. This behavior can be 
changed on the settings pane by allowing MQTT publishing. Further the list of 
allowed topics can be specified. When the list is empty any topic can be 
published. Otherwise it contains a comma-separated list of MQTT topic patterns. 
A topic is published if it matches at least one item from the list.</p>
<p>MQTT publishing can be used together with Python scripting to connect 
external sensors connected to a MQTT client. The client can publish sensor 
readings as retained MQTT topics on the MAX! home automation MQTT broker. The 
Python script can read the published messages (see
<a href="#elv_max_cube.get_mqtt_message">get_mqtt_message</a>) and use the data 
for control.</p>

<hr>
<p align="right">
  <A name="4"></A><a href="#3">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#5"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>4. Logging into a database</H2>
<p>The device data can be stored into a database, for example in order to 
accumulate long-term statistics. New data are logged only if changed. Repeating 
values are ignored.</p>
<H3>4.1. <a name="4.1"></a>Database configuration</H3>
<p>The <i>settings</i> pane has <i>database</i> section allowing database 
configuration:</p>
<blockquote>
	<p><img border="0" src="max-cube-logging.png" width="759" height="480" alt="logging"></p>
</blockquote>
<p>ODBC and SQLite are supported interfaces.</p>
<h4>4.1.1 ODBC</h4>
<p>ODBC stands for <span class="_Tgc"><b>O</b>pen <b>D</b>ata<b>b</b>ase <b>C</b>onnectivity. 
The database configuration consists of:</span></p>
<ul>
	<li><span class="_Tgc"><i>Data source name</i>. The DSN indentifies the 
	database to use;</span></li>
	<li><span class="_Tgc"><i>User</i> is the user name to access to database;</span></li>
	<li><span class="_Tgc"><i>Password</i> is the password.</span></li>
</ul>
<p><span class="_Tgc">The database may be located on a different computer and 
run under a different OS.</span></p>
<ul>
	<li><span class="_Tgc">Under MS-Windows ODBC is configured by typing <i>set 
	up ODBC data sources</i>. This will bring Windows ODBC administrator tool, 
	where the driver and DSN can be set up.</span></li>
	<li><span class="_Tgc">Under Linux ODBC is provided by unixODBC package. See
	<a href="http://www.unixodbc.org/">http://www.unixodbc.org/</a> for further 
	information.</span></li>
</ul>
<p><span class="_Tgc">ODBC drivers are provided by the database vendors. Most 
commonly used databases support ODBC, e.g. Microsoft SQL Server, Microsoft 
Access, Oracle, Sybase, MySQL, PostgreSQL to name few.</span></p>
<h4>4.1.2 SQLite</h4>
<p>SQLite is a single-file database. All database is stored in the file which is 
usually located on the local file system. The database file name is all that has 
to be configured. When the file does not exist, it is automatically created.</p>
<H3>4.2. <a name="4.2"></a>The database structure</H3>
<p>The data are stored into the table named <i>datalog</i>. The table has the 
following columns:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Name</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
  <tr>
    <TD valign="top">time_stamp</TD>
    <TD align="center" valign="top"> String<br>
&nbsp;or<br>
	Timestamp</TD>
    <TD align="left" valign="top"> 
	<ul>
		<li>For SQLite the timestamp is a text in the format: 2017-02-18 
		14:00:30.12</li>
		<li>For ODBC a database native timestamp type is used</li>
	</ul>
	</TD>
  </tr>
	<tr>
    <TD valign="top">address</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> The RF-address of the device</TD>
  </tr>
	<tr>
    <TD valign="top">device_type</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top">  

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Device</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Value</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">cube </TD>
    <TD align="center"> 0</TD>
  </TR>
  <TR>
    <TD valign="top">radiator thermostat</TD>
    <TD align="center"> 1</TD>
  </TR>
  <tr>
    <TD valign="top">radiator thermostat plus</TD>
    <TD align="center"> 2</TD>
  </tr>
	<tr>
    <TD valign="top">wall thermostat</TD>
    <TD align="center"> 3</TD>
  </tr>
	<tr>
    <TD valign="top">shutter contact</TD>
    <TD align="center"> 4</TD>
  </tr>
	<tr>
    <TD valign="top">eco button</TD>
    <TD align="center"> 5</TD>
  </tr>
	<tr>
    <TD valign="top">unknown</TD>
    <TD align="center"> 6</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
  <TR>
    <TD valign="top">set_temperature</TD>
    <TD align="center" valign="top"> Real</TD>
    <TD align="left" valign="top"> The temperature kept by the thermostat</TD>
  </TR>
  <TR>
    <TD valign="top">new_temperature</TD>
    <TD align="center" valign="top"> Real</TD>
    <TD align="left" valign="top"> The new temperature for the thermostat. It 
	differs from the above if the thermostat is not yet aware of the change</TD>
  </TR>
  <TR>
    <TD valign="top">is_temperature</TD>
    <TD align="center" valign="top"> Real</TD>
    <TD align="left" valign="top"> The actual room temperature</TD>
  </TR>
  <TR>
    <TD valign="top">offset</TD>
    <TD align="center" valign="top"> Real</TD>
    <TD align="left" valign="top"> The temperature offset to add to the 
	set-temperature. The result is used as the target by the thermostat</TD>
  </TR>
  <TR>
    <TD valign="top">valve_position</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..100. The value 100 corresponds to a fully 
	open valve</TD>
  </TR>
  <TR>
    <TD valign="top">contact_open</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..1. The value 1 means open contact. This 
	column is filled by window shutter contacts</TD>
  </TR>
  <TR>
    <TD valign="top">error</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..1. The value 1 means error</TD>
  </TR>
  <TR>
    <TD valign="top">duty</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..100. This column is filled by cube</TD>
  </TR>
  <TR>
    <TD valign="top">slots</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> The number of free slots. This column is 
	filled by cube</TD>
  </TR>
  <TR>
    <TD valign="top">battery_low</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top">panel_locked</TD>
    <TD align="center" valign="top"> Integer</TD>
    <TD align="left" valign="top"> 0..1</TD>
  </TR>
  <TR>
    <TD valign="top">current_mode</TD>
    <TD align="center" valign="top"> &nbsp;</TD>
    <TD align="left" valign="top">  

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Mode</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Value</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">automatic</TD>
    <TD align="center"> 0</TD>
  </TR>
  <TR>
    <TD valign="top">manual</TD>
    <TD align="center"> 1</TD>
  </TR>
  <tr>
    <TD valign="top">boost</TD>
    <TD align="center"> 2</TD>
  </tr>
	<tr>
    <TD valign="top">vacation</TD>
    <TD align="center"> 3</TD>
  </tr>
	</TABLE>

	</TD>
  </TR>
  </TABLE>

<p>The table is created automatically if does not exist. For ODBC data types of 
the columns are selected according to the capacities of the database management 
system (DBMS). If a column or columns are not defined or do not apply to the 
value is set to NULL. For example, when data of a shutter contact are stored, 
the <i>set_temperature</i> is written as NULL.</p>

<hr>
<p align="right">
  <A name="5"></A><a href="#4">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#6"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>5. Scripting</H2>
<H3>5.1. <a name="5.1"></a>Python scripting</H3>
<p>Simple control tasks can be performed by providing a Python script to be 
called periodically. The script can access the application through the module <i>elv_max_cube</i>. 
The module is loaded as shown in the following example:</p><TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt><font color="#008000"># Minimal 
	controller script<br>
	</font><b><font color="#0000FF">import</font></b> elv_max_cube<br>
<b><font color="#0000FF">def </font></b>controller (*args):<br>
&nbsp;&nbsp; elv_max_cube.trace (<font color="#FF0000">&quot;Hello 
	there!&quot;</font>)</tt></TD>
  </TR>
</TABLE>
<p>The settings pane has Python script settings:</p>
<blockquote>
	<H3><img border="0" src="max-python-script.png" alt="Python script"></H3>
</blockquote>
<p>Here the fields are:</p>
<ul>
	<li><i>Python library</i> is the dynamic library of the Python interpreter. 
	If the library name is relative the path to it must be in the system library 
	path;</li>
	<li><i>Script file name</i> is the name of the script to execute. It must 
	have the name <i>controller.py</i>. Python usually can load only scripts 
	located in the same directory as the application or in the Python directory. 
	If the script is located elsewhere, it must be specified by full path;</li>
	<li><i>Invoke period</i> specifies how frequently the script must be 
	executed. This is the time to wait before next call of the script;</li>
	<li><i>Start delay</i> specifies the time before the first invocation of the 
	script. You want to make sure that the cube completes handshake procedure 
	before starting the script.</li>
</ul>
<H3>5.2. <a name="5.2"></a>Python module elv_max_cube</H3>
<p>The following methods are provided by the module <i>elv_max_cube</i>:</p>
<table border="0" cellpadding="0" cellspacing="20">
<tr><td valign="top">
<a href="#elv_max_cube.disconnect">disconnect</a><br>
<a href="#elv_max_cube.get_battery">get_battery</a><br>
<a href="#elv_max_cube.get_connection">get_connection</a><br>
<a href="#elv_max_cube.get_cubes_list">get_cubes_list</a><br>
<a href="#elv_max_cube.get_devices_list">get_devices_list</a><br>
<a href="#elv_max_cube.get_duty">get_duty</a><br>
<a href="#elv_max_cube.get_link">get_link</a></td>
<td valign="top">
<a href="#elv_max_cube.get_mode">get_mode</a><br>
<a href="#elv_max_cube.get_mqtt_message">get_mqtt_message</a><br>
<a href="#elv_max_cube.get_parameters">get_parameters</a><br>
<a href="#elv_max_cube.get_set_temperature">get_set_temperature</a><br>
<a href="#elv_max_cube.get_status">get_status</a><br>
<a href="#elv_max_cube.get_summer_time">get_summer_time</a><br>
<a href="#elv_max_cube.get_temperature">get_temperature</a></td>
<td valign="top">
<a href="#elv_max_cube.get_valve">get_valve</a><br>
<a href="#elv_max_cube.get_valve_statistics">get_valve_statistic</a><br>
<a href="#elv_max_cube.publish_mqtt_message">publish_mqtt_message</a><br>
<a href="#elv_max_cube.reboot">reboot</a><br>
<a href="#elv_max_cube.reconnect">reconnect</a><br>
<a href="#elv_max_cube.set_mode">set_mode</a><br>
<a href="#elv_max_cube.trace">trace</a></td>
</tr>
</table>
<h4>5.2.1. disconnect</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.disconnect"></a>elv_max_cube.disconnect (<i>cube</i>)</tt></p>
</blockquote>
<p>This method disconnects from the cube specified by the parameter <i>cube</i> 
which is the RF address of the cube. Note that the operation is asynchronous, 
the call only initiates disconnection. TypeError is raised when no such cube 
exists.</p>
<h4>5.2.2. get_battery</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_battery"></a>elv_max_cube.get_battery (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the battery state by the RF address of the cube and the 
RF address of the device. The result is '<i>high</i>' or '<i>low</i>'. TypeError 
is raised when no device was found or it has no battery. For example the following code lists 
battery state of a device:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Battery 
state: &quot;</font> + 
elv_max_cube.get_battery<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>))</tt></p>
</blockquote>
<h4>5.2.3. get_connection</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_connection"></a>elv_max_cube.get_connection (<i>cube</i>)</tt></p>
</blockquote>
<p>This method returns cube connection status. The parameter <i>cube</i> is the RF 
address of the cube. The result is one of <i>'connected'</i>, '<i>disconnected'</i>, 
'<i>unknown'</i>. The string '<i>unknown'</i> is returned when cube does not 
specify a known cube.</p>
<h4>5.2.4. get_cubes_list</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_cubes_list"></a>elv_max_cube.get_cubes_list</tt></p>
</blockquote>
<p>This method returns the list of RF addresses, one address for each detected 
cube. For example the following code lists all cubes:</p>
<blockquote>
	<p><tt>cubes_list = elv_max_cube.get_cubes_list ()<br>
elv_max_cube.trace (<font color="#FF0000">&quot;MAX! cubes detected: &quot;</font> + 
<font color="#FF0000">&quot;, &quot;</font>.join (<font color="#FF0000">'{:06X}'</font>.format (cube) 
<font color="#0000FF"><b>for</b></font> cube <font color="#0000FF"><b>in</b></font> cubes_list))</tt></p>
</blockquote>
<h4>5.2.5. get_devices_list</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_devices_list"></a>elv_max_cube.get_devices_list (<i>cube</i>, <i>device_types</i>)</tt></p>
</blockquote>
<p>This method returns the list of RF addresses of the devices managed by the 
cube and filtered by the type. The parameter <i>cube</i> is the RF address of 
the cube. When 0 the devices are taken from any cube. device_types is the list 
of device types to accept. It can contain any of: <i>'cube'</i>, 'r<i>adiator thermostat'</i>, 
'r<i>adiator thermostat plus'</i>, <i>'wall thermostat'</i>, <i>'shutter contact'</i>,
<i>'eco button'</i>. The following example lists all radiator thermostats 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>thermostats_list = elv_max_cube.get_devices_list (<font color="#800000">0x0BB8F0</font>, 
['radiator thermostat', 'radiator thermostat plus'])<br>
elv_max_cube.trace (<font color="#FF0000">&quot;Thermostats: &quot;</font> + 
<font color="#FF0000">&quot;, &quot;</font>.join (<font color="#FF0000">'{:06X}'</font>.format (thermostat)
<font color="#0000FF"><b>for</b></font> thermostat <font color="#0000FF"><b>in</b></font> 
thermostats_list))</tt></p>
</blockquote>
<h4>5.2.6. get_duty</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_duty"></a>elv_max_cube.get_duty (<i>cube</i>)</tt></p>
</blockquote>
<p>This method returns the duty of the cube 0.0..1.0. When the value reaches its 
maximum the cube stops sending anything and waits for an hour.</p>
<h4>5.2.7. get_link</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_link"></a>elv_max_cube.get_link (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the link state by the RF address of the cube and the RF 
address of the device. The result is '<i>error</i>' or '<i>ok</i>'. TypeError is 
when no device was found or it has no link state. For example the following code 
shows link state of a device:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Link 
state: &quot;</font> + 
elv_max_cube.get_link<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>))</tt></p>
</blockquote>
<h4>5.2.8. get_mode</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_mode"></a>elv_max_cube.get_mode (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the operating mode of the device by the RF address of the cube and the RF 
address of the device. The result is '<i>automatic</i>', '<i>manual</i>', '<i>boost</i>', 
'<i>vacation</i>'. TypeError is raised when no device was found or it has no mode. For example the following code lists 
the mode of a device:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Mode: &quot;</font> + 
elv_max_cube.get_mode<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>))</tt></p>
</blockquote>
<h4>5.2.9. get_mqtt_message</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_mqtt_message"></a>elv_max_cube.get_mqtt_message (<i>topic</i>)</tt></p>
</blockquote>
<p>This method returns retained message from the MAX! home automation broker. 
The parameter <i>topic</i> specifies the message topic. When the topic is 
invalid or when no message exists TypeError is raised. The 
following example illustrates getting topic <i>Greeting:</i></p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Message: &quot;</font> + 
elv_max_cube.get_mqtt_message (<font color="#FF0000">&quot;Greeting&quot;</font>))</tt></p>
</blockquote>
<h4>5.2.10. get_parameters</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_parameters"></a>elv_max_cube.get_parameters (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns a dictionary describing parameters of&nbsp; <i>device</i> 
handled by <i>cube</i>. The dictionary contains the following keys some of which 
can be absent depending on the device type:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">address</TD>
    <TD align="center" valign="top"> long</TD>
    <TD align="left" valign="top"> The RF-address of the device</TD>
  </tr>
	<tr>
    <TD valign="top">airing temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat room airing temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">airing mode delay</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The duration in the format HH:MM</TD>
  </tr>
	<tr>
    <TD valign="top">boost duration</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The duration of the thermostat boost mode in 
	the format HH:MM</TD>
  </tr>
	<tr>
    <TD valign="top">boost valve position</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The valve position in the boost mode in the 
	range 0..1. 1 corresponds to a fully open valve</TD>
  </tr>
	<tr>
    <TD valign="top">comfort temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat comfort temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">decalcification time</TD>
    <TD align="center" valign="top"> dictionary</TD>
    <TD align="left" valign="top"> The week day and time to perform the 
	procedure:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">day</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The week day, e.g. <i>'Monday'</i></TD>
  </tr>
	<tr>
    <TD valign="top">time</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The time in the format HH:MM</TD>
  </tr>
  </TABLE>

		</TD>
  </tr>
	<tr>
    <TD valign="top">eco temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat eco temperature, when in the 
	'eco' mode (Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">maximum valve position</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat maximum valve position in the 
	range 0..1. 1 corresponds to a fully open valve</TD>
  </tr>
	<tr>
    <TD valign="top">maximum temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat maximal temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">minimum temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat minimum temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">room</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The device's room name</TD>
  </tr>
	<tr>
    <TD valign="top">room id</TD>
    <TD align="center" valign="top"> long</TD>
    <TD align="left" valign="top"> The ID number of the device's room</TD>
  </tr>
	<tr>
    <TD valign="top">name</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The device name</TD>
  </tr>
	<tr>
    <TD valign="top">schedule</TD>
    <TD align="center" valign="top"> dictionary</TD>
    <TD align="left" valign="top"> The thermostat schedule in the automatic 
	mode:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">Monday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Monday. 
	The points in the list are ordered by the time. Each point is the 
	dictionary:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">until</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The time in the format HH:MM until the 
	specified temperature must be held</TD>
  </tr>
	<tr>
    <TD valign="top">temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The set temperature in Centigrade</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
	<tr>
    <TD valign="top">Tuesday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Tuesday</TD>
  </tr>
	<tr>
    <TD valign="top">Wednesday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on 
	Wednesday</TD>
  </tr>
	<tr>
    <TD valign="top">Thursday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Thursday</TD>
  </tr>
	<tr>
    <TD valign="top">Friday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Friday</TD>
  </tr>
	<tr>
    <TD valign="top">Saturday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Saturday</TD>
  </tr>
	<tr>
    <TD valign="top">Sunday</TD>
    <TD align="center" valign="top"> list</TD>
    <TD align="left" valign="top"> The thermostat scheduling points on Sunday</TD>
  </tr>
  </TABLE>

	</TD>
  </tr>
	<tr>
    <TD valign="top">serial no</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The device serial number</TD>
  </tr>
	<tr>
    <TD valign="top">temperature offset</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The thermostat temperature offset 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">type</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top">  

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Device</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">cube </TD>
  </TR>
  <TR>
    <TD valign="top">radiator thermostat</TD>
  </TR>
  <tr>
    <TD valign="top">radiator thermostat plus</TD>
  </tr>
	<tr>
    <TD valign="top">wall thermostat</TD>
  </tr>
	<tr>
    <TD valign="top">shutter contact</TD>
  </tr>
	<tr>
    <TD valign="top">eco button</TD>
  </tr>
	<tr>
    <TD valign="top">unknown</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
  <TR>
    <TD valign="top">valve offset</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The value 1.0 corresponds to a fully 
	open valve</TD>
  </TR>
  </TABLE>

<p>TypeError occurs when no device was found. The following example illustrates 
tracing state of the thermostat 0B76DA 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Parameters &quot;</font> 
+ str (elv_max_cube.get_parameters (<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4><span style="font-weight: 400">Possible output could be: <i>Status {'type': 
'radiator thermostat', 'address': 751322, 'mode': 'manual', 'error': True, 
'initialized': True, 'valve': 0.1298828125, 'set temperature': 17.0, 'new 
temperature': 17.0, 'panel locked': False, 'battery low': False, 'link error': 
False, 'summer time': True}</i></span></h4>
<h4>5.2.11. get_set_temperature</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_set_temperature"></a>elv_max_cube.get_set_temperature (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the current set temperature by the RF address of the 
cube and the RF address of the device. The result is the temperature in 
Centigrade. The set temperature is used to control the radiator. TypeError is when no device was found or it has no temperature. 
For example the following code lists the set temperature:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Set temperature: &quot;</font> + 
str (elv_max_cube.get_set_temperature<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.2.12. get_status</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_status"></a>elv_max_cube.get_status (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns a dictionary describing status of&nbsp; <i>device</i> 
handled by <i>cube</i>. The dictionary contains the following keys some of which 
can be absent depending on the device type:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">address</TD>
    <TD align="center" valign="top"> long</TD>
    <TD align="left" valign="top"> The RF-address of the device</TD>
  </tr>
	<tr>
    <TD valign="top">battery low</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if battery is low</TD>
  </tr>
	<tr>
    <TD valign="top">error</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if error</TD>
  </tr>
	<tr>
    <TD valign="top">initialized</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if initialized</TD>
  </tr>
	<tr>
    <TD valign="top">link error</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if link error</TD>
  </tr>
	<tr>
    <TD valign="top">mode</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top">  

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Mode</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">automatic</TD>
  </TR>
  <TR>
    <TD valign="top">manual</TD>
  </TR>
  <tr>
    <TD valign="top">boost</TD>
  </tr>
	<tr>
    <TD valign="top">vacation</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
	<tr>
    <TD valign="top">new temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The new temperature for the thermostat. It 
	differs from the above if the thermostat is not yet aware of the change</TD>
  </tr>
	<tr>
    <TD valign="top">open</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if shutter contact is open</TD>
  </tr>
	<tr>
    <TD valign="top">panel locked</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if locked</TD>
  </tr>
	<tr>
    <TD valign="top">set temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The temperature kept by the thermostat</TD>
  </tr>
	<tr>
    <TD valign="top">summer time</TD>
    <TD align="center" valign="top"> True/False</TD>
    <TD align="left" valign="top"> True if summer time</TD>
  </tr>
	<tr>
    <TD valign="top">temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The actual room temperature, if known</TD>
  </tr>
	<tr>
    <TD valign="top">type</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top">  

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Device</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">cube </TD>
  </TR>
  <TR>
    <TD valign="top">radiator thermostat</TD>
  </TR>
  <tr>
    <TD valign="top">radiator thermostat plus</TD>
  </tr>
	<tr>
    <TD valign="top">wall thermostat</TD>
  </tr>
	<tr>
    <TD valign="top">shutter contact</TD>
  </tr>
	<tr>
    <TD valign="top">eco button</TD>
  </tr>
	<tr>
    <TD valign="top">unknown</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
  <TR>
    <TD valign="top">valve</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The value 1.0 corresponds to a fully 
	open valve</TD>
  </TR>
  </TABLE>

<p>TypeError is when no device was found. The following example illustrates 
tracing state of the thermostat 0B76DA&nbsp; 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Status &quot;</font> 
+ str (elv_max_cube.get_status (<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4><span style="font-weight: 400">Possible output could be: <i>Status {'type': 
'radiator thermostat', 'address': 751322, 'mode': 'manual', 'error': True, 
'initialized': True, 'valve': 0.1298828125, 'set temperature': 17.0, 'new 
temperature': 17.0, 'panel locked': False, 'battery low': False, 'link error': 
False, 'summer time': True}</i></span></h4>
<h4>5.2.13. get_summer_time</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_summer_time"></a>
	elv_max_cube.get_summer_time (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the daytime saving mode of device specified by the RF 
address of the cube and the RF address of the device. True is he result when the 
summer time is active. TypeError is when no device was found or it has no time 
mode settings. For example the following code shows the active daytime saving 
mode:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Summer time: &quot;</font> + 
	str (elv_max_cube.get_summer_time<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.2.14. get_temperature</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_temperature"></a>elv_max_cube.get_temperature (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the current measured temperature by the RF address of the 
cube and the RF address of the device. The result is the measured temperature in 
Centigrade. TypeError is when no device was found, it has no temperature or when the temperature is 
yet unknown. For example the following code lists 
the measured temperature:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Temperature: &quot;</font> + 
str (elv_max_cube.get_temperature<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.2.15. get_valve</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_valve"></a>elv_max_cube.get_valve (<i>cube</i>, <i>device</i>)</tt></p>
</blockquote>
<p>This method returns the valve position of a thermostat specified by the RF address of the 
cube and the RF address of the device. The result is in the range 0..1. The 
value 1 corresponds to a fully open valve. TypeError is when no device was found or it 
is not a thermostat. For example the following code shows the valve position of 
a thermostat:</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Valve: &quot;</font> + 
str (elv_max_cube.get_valve<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>,
<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.2.16. get_valve_statistics</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.get_valve_statistics"></a>elv_max_cube.get_valve_statistics (<i>cube</i>)</tt></p>
</blockquote>
<p>This method returns the statistics of the current thermostat valve positions. 
The parameter <i>cube</i> is the RF address of the 
cube which thermostats are queried. The result is the dictionary:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">average</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The average valve position</TD>
  </tr>
	<tr>
    <TD valign="top">maximum</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The maximal valve position</TD>
  </tr>
	<tr>
    <TD valign="top">minimum</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The minimal valve position</TD>
  </tr>
	</TABLE>

<p>The valve position is in the range 0..1. The value 1 corresponds to a fully 
open valve. When there is no thermostats corresponding, the returned fields are 
0.</p>
<blockquote>
	<p><tt>elv_max_cube.trace (<font color="#FF0000">&quot;Average 
valve position: &quot;</font> + 
str (elv_max_cube.get_valve_statistics<font color="#FF0000"> </font>(<font color="#800000">0x0BB8F0</font>) 
['average']))</tt></p>
</blockquote>
<h4>5.2.17. publish_mqtt_message</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.publish_mqtt_message"></a>elv_max_cube.publish_mqtt_message (<i>topic</i>,
	<i>message</i> [, <i>policy</i>])</tt></p>
</blockquote>
<p>This method publishes <i>topic</i> with the message specified by <i>message</i>&nbsp; the statistics of the current thermostat valve positions. 
The parameter <i>policy</i> is specifies how to handle the message:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Policy</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Description</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">Transient</TD>
    <TD align="left" valign="top"> The message is not retained, only active 
	subscriptions get it</TD>
  </tr>
	<tr>
    <TD valign="top">Retained</TD>
    <TD align="left" valign="top"> The message always replaces the retained one</TD>
  </tr>
	<tr>
    <TD valign="top">Updated</TD>
    <TD align="left" valign="top"> Ignored if same as the retained one, 
	otherwise it replaces the old one. This is the default</TD>
  </tr>
	<tr>
    <TD valign="top">Initial</TD>
    <TD align="left" valign="top"> Ignored if already retained</TD>
  </tr>
	<tr>
    <TD valign="top">Ignored</TD>
    <TD align="left" valign="top"> The message is ignored</TD>
  </tr>
	</TABLE>

<p>The following example illustrates publishing topic <i>Greeting</i> with the 
message <i>Hi!</i></p>
<blockquote>
	<p><tt>elv_max_cube.publish_mqtt_message (<font color="#FF0000">&quot;Greeting&quot;</font>,
<font color="#FF0000">&quot;Hi!&quot;</font>)</tt></p>
</blockquote>

<h4>5.2.18. reboot</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.reboot"></a>elv_max_cube.reboot (<i>serial-number</i>)</tt></p>
</blockquote>
<p>This method is used to reboot a cube. The cube is identified by it 
10-characters serial number. 
There is no return value.</p>

<h4>5.2.19. reconnect</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.reconnect"></a>elv_max_cube.reconnect (<i>cube</i>)</tt></p>
</blockquote>
<p>This method reconnects to the cube specified by the parameter <i>cube</i> 
which is the RF address of the cube. Note that the operation is asynchronous, 
the call only initiates reconnection. TypeError is raised when no such cube 
exists.</p>
<h4>5.2.20. set_mode</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.set_mode"></a>elv_max_cube.set_mode (<i>mode</i>, 
	<i>cube</i>, <i>device</i>, <i>temperature, disposition, until</i>)</tt></p>
</blockquote>
<p>This method sets one or several thermostats into the specified mode. The 
method takes keyed parameters with the names given in the following table:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">mode</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The thermostat mode to set:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Mode</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">automatic</TD>
  </TR>
  <TR>
    <TD valign="top">manual</TD>
  </TR>
  <tr>
    <TD valign="top">boost</TD>
  </tr>
	<tr>
    <TD valign="top">vacation</TD>
  </tr>
	</TABLE>
	<p>This parameter is obligatory. If omitted TypeError is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">cube</TD>
    <TD align="center" valign="top"> long</TD>
    <TD align="left" valign="top"> The RF address of the cube of which 
	thermostats must be set. This parameter must be always present. If omitted 
	TypeError is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">device thermostat</TD>
    <TD align="center" valign="top"> long</TD>
    <TD align="left" valign="top"> The RF address of the thermostat to set. This 
	parameter is optional. Then absent the mode is set into all thermostats of 
	the cube. The parameter key can be either <i>device</i> or <i>thermostat</i>.</TD>
  </tr>
	<tr>
    <TD valign="top">temperature</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The temperature in Centigrade. This parameter 
	is optional if the temperature is not required or specified by other means. 
	When required but not specified TypeError is raised. The temperature is 
	either absolute or relative to the current temperature as specified by the 
	parameter <i>disposition</i>.</TD>
  </tr>
	<tr>
    <TD valign="top">disposition</TD>
    <TD align="center" valign="top"> string</TD>
    <TD align="left" valign="top"> The parameter specifies how to treat the 
	temperature parameter:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Disposition</b></font></TD>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Meaning</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">absolute</TD>
    <TD valign="top">The value of the parameter temperature is used as-is for 
	the mode to set. The <i>temperature</i> parameter must be present, otherwise 
	TypeError is raised. This is the default when the <i>temperature</i> 
	parameter is specified.</TD>
  </TR>
  <tr>
    <TD valign="top">airing</TD>
    <TD valign="top">The airing mode temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise TypeError is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">comfort</TD>
    <TD valign="top">The comfort temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise TypeError is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">decrement</TD>
    <TD valign="top">The value of the parameter temperature is used to decrement 
	the current temperature, the result is used for the mode. The <i>temperature</i> 
	parameter must be present, otherwise TypeError is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">eco</TD>
    <TD valign="top">The eco temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise TypeError is raised.</TD>
  </tr>
  <TR>
    <TD valign="top">increment</TD>
    <TD valign="top">The value of the parameter temperature is used to increment 
	the current temperature, the result is used for the mode. The <i>temperature</i> 
	parameter must be present, otherwise TypeError is raised.</TD>
  </TR>
  	</TABLE></TD>
  </tr>
	<tr>
    <TD valign="top">until</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The duration of the set mode in seconds. This 
	parameter must appear when the mode is <i>vacation</i>. It must be absent 
	for any other mode, otherwise TypeError is raised.</TD>
  </tr>
	</TABLE>

<p>The method is asynchronous. It only initiates setting the mode, which can 
take a considerable time or fail when the RF traffic is exhausted. The following 
example sets all thermostats to hold the eco temperature for one day:</p>
<blockquote>
	<p><tt>elv_max_cube.set_mode (cube=<font color="#800000">0x0BB8F0</font>,
mode=<font color="#FF0000">'vacation'</font>, disposition=<font color="#FF0000">'eco'</font>, 
until=<font color="#800000">3600</font>*<font color="#800000">24</font>)</tt></p>
</blockquote>
<h4>5.2.21. trace</h4>
<blockquote>
	<p><tt><a name="elv_max_cube.trace"></a>elv_max_cube.trace (<i>message</i>)</tt></p>
</blockquote>
<p>This method sends the argument message to the application's trace panel. 
There is no return value.</p>

<H3>5.3. <a name="5.3"></a>Maintaining state between calls of the script</H3>
<p>Frequently it is necessary to keep certain data from one call to the script 
to another. When the script returns an object, which can be of any type, then 
this object is passed to the next call of the script as the single argument. 
During the first call the argument is set to <i>None</i>. The following example 
illustrates the concept by incrementing the count each time the script is 
called:</p>

<TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt><b><font color="#0000FF">import</font></b> elv_max_cube<br>
<b><font color="#0000FF">def </font></b>controller (*args):<br>
&nbsp;&nbsp; <b><font color="#0000FF">if</font></b> args [<font color="#800000">0</font>]
<font color="#0000FF">is</font> None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = <font color="#800000">0</font><br>
&nbsp;&nbsp; <font color="#0000FF">else</font>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = args [<font color="#800000">0</font>] +
<font color="#800000">1</font><br>
&nbsp;&nbsp; elv_max_cube.trace (<font color="#FF0000">&quot;Count =&quot;</font> + str 
(result))<br>
&nbsp;&nbsp; <font color="#0000FF">return</font> result</tt></TD>
  </TR>
</TABLE>

<p>When the argument <i>args [0] </i>is <i>None</i>, 0 is returned. Otherwise <i>
args [0]</i> is incremented and then returned. Naturally, the result can be of 
any type. E.g. it can be a dictionary or list.</p>

<H3>5.4. <a name="5.4"></a>Controlling a boiler with an ESP8266 and a relay</H3>
<p>This example illustrates using scripting in connection with MQTT messaging 
to control a boiler. The following picture illustrates the setup:</p>
<blockquote>
	<p>
	<img border="0" src="elv_home_automation_ESP8266_example.png" width="609" height="272" alt="example"></p>
</blockquote>
<p>Here the components are:</p>
<ul>
	<li>Radiator thermostats which valves are monitored in order to turn the 
	boiler on or off;</li>
	<li>MAX! cube;</li>
	<li>Raspberry Pi 2 or 3 running a Linux OS with MAX! home automation;</li>
	<li>NodeMCU ESP8266 12E running <a href="https://www.arduino.cc/en/Main/Software">Arduino</a>;</li>
	<li>Wemos D1 mini relay put on top of ESP8226.</li>
</ul>
<p>MAX! home automation runs the following script:</p>

<TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt><b><font color="#0000FF">import</font></b> elv_max_cube<br>
<b><font color="#0000FF">def </font></b>controller (*args):<br>
&nbsp;&nbsp; <font color="#0000FF">if</font> elv_max_cube.get_valve_statistics (<font color="#800000">0xBB8F0</font>) 
[<font color="#FF0000">&quot;average&quot;</font>] &gt; <font color="#800000">0.1</font>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elv_max_cube.publish_mqtt_message (<font color="#FF0000">&quot;relay&quot;</font>,
<font color="#FF0000">&quot;on&quot;</font>)<br>
&nbsp;&nbsp; <font color="#0000FF">else</font>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elv_max_cube.publish_mqtt_message (<font color="#FF0000">&quot;relay&quot;</font>,
<font color="#FF0000">&quot;off&quot;</font>)</tt></TD>
  </TR>
</TABLE>

<p>The script takes the valves statistics of the radiator thermostats of the 
cube. Here BB8F0 is the cube's RF-address. It compares the averaged valve 
position. If that is bigger that 10% the topic <i>relay</i> is published as <i>
on</i>. Otherwise it is published as <i>off</i>.</p>
<blockquote>
	<table border="0">
		<tr>
			<td valign="bottom" align="center">
			NodeMCU<br>
&nbsp;ESP8266 12E</td>
			<td align="center">&nbsp;</td>
			<td valign="bottom" align="center">
			Wemos D1<br>
			mini relay</td>
			<td align="center">
			&nbsp;</td>
			<td valign="bottom" align="center">
			&nbsp;</td>
		</tr>
		<tr>
			<td valign="bottom" align="center">
			<img border="0" src="nodemcu_esp8266_esp_12.png" alt="nodemcu ESP8266"></td>
			<td align="center"><big><big>+</big></big></td>
			<td valign="bottom" align="center">
			<img border="0" src="wemos_d1_mini_relay_module.png" alt="WEMOS DL"></td>
			<td align="center">
			<big><big>=</big></big></td>
			<td valign="bottom" align="center">
			<img border="0" src="esp8266_and_relay.png" alt="ESP8266 and relay"></td>
		</tr>
		</table>
</blockquote>
<p>Now the <a href="https://www.arduino.cc/en/Main/Software">Arduino</a> program 
in C++ for ESP8266:</p>

<TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#C4E1FF"><tt><font color="#0000FF">#include</font> &lt;OneWire.h&gt;<br>
<font color="#0000FF">#include</font> &lt;ESP8266WiFi.h&gt;<br>
<font color="#0000FF">#include</font> &lt;PubSubClient.h&gt;<br>
<br>
<font color="#0000FF">const char</font> *&nbsp; WiFi_SSID&nbsp;&nbsp;&nbsp;&nbsp; 
= <font color="#FF0000">&quot;<i>&lt;your WiFi network&gt;</i>&quot;</font>;<br>
<font color="#0000FF">const char</font> *&nbsp; WiFi_Password =
<font color="#FF0000">&quot;<i>&lt;your WiFi password&gt;</i>&quot;</font>;<br>
<font color="#0000FF">const char</font> *&nbsp; MQTT_Server&nbsp;&nbsp; =
<font color="#FF0000">&quot;<i>&lt;your MAX! home automation IP address&gt;</i>&quot;</font>;<br>
<font color="#0000FF">const int</font>&nbsp;&nbsp;&nbsp;&nbsp; MQTT_Port&nbsp;&nbsp;&nbsp;&nbsp; 
= <font color="#800000">1883</font>;<br>
<font color="#0000FF">const int</font>&nbsp;&nbsp;&nbsp;&nbsp; Relay_Pin&nbsp;&nbsp;&nbsp;&nbsp; 
= D1;<br>
<br>
OneWire&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One_Wire_Bus (<font color="#800000">4</font>);
<font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // onewire bus</font><br>
WiFiClient&nbsp;&nbsp;&nbsp; Networking;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#008000">// WiFi</font><br>
PubSubClient&nbsp; MQTT_Client (Networking); <font color="#008000">// MQTT</font><br>
<br>
<font color="#0000FF">void</font> Update_Subscription (<font color="#0000FF">char</font> 
* topic, <font color="#0000FF">byte</font> * payload, <font color="#0000FF">
unsigned int</font> length)<br>
{&nbsp; <font color="#008000">// This is called each time any subscribed topic 
arrive</font><br>
&nbsp;&nbsp; <font color="#0000FF">if</font> (<font color="#800000">0</font> == 
strcmp (topic, <font color="#FF0000">&quot;relay&quot;</font>))<br>
&nbsp;&nbsp; {&nbsp; <font color="#008000">// This is the topic &quot;relay&quot; we are 
interested in</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">if</font> (<font color="#800000">2</font> 
&lt;= length &amp;&amp; 'o' == payload [<font color="#800000">0</font>] &amp;&amp; 'n' == payload [<font color="#800000">1</font>])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; <font color="#008000">// Turn on</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot;Relay on&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite (Relay_Pin, HIGH);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; <font color="#008000">// Turn off</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot;Relay 
off&quot;</font>); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite (Relay_Pin, LOW);<br>
&nbsp;&nbsp; }&nbsp; }<br>
}<br>
<br>
<font color="#0000FF">void</font> setup ()<br>
{&nbsp; <font color="#008000">// This is called once upon start</font><br>
&nbsp;&nbsp; Serial.begin (<font color="#800000">9600</font>);<font color="#008000"> 
// Initiate serial console with 9600 baud</font><br>
&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot;Starting&quot;</font>);<br>
<br>
&nbsp;&nbsp; pinMode (Relay_Pin, OUTPUT);<font color="#008000"> // Configure relay</font><br>
&nbsp;&nbsp; setup_wifi (); <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Setup WIFI<br>
</font><br>
&nbsp;&nbsp; <font color="#008000">// Setup MQTT, but connect later from the 
main loop</font><br>
&nbsp;&nbsp; MQTT_Client.setServer (MQTT_Server, MQTT_Port);<br>
&nbsp;&nbsp; MQTT_Client.setCallback (&amp;Update_Subscription);<br>
}<br>
<br>
<font color="#0000FF">void</font> setup_wifi ()<br>
{<br>
&nbsp;&nbsp; delay (<font color="#800000">10</font>);<br>
&nbsp;&nbsp; <font color="#008000">// We start by connecting to a WiFi network</font><br>
&nbsp;&nbsp; Serial.println ();<br>
&nbsp;&nbsp; Serial.print (<font color="#FF0000">&quot;Connecting to &quot;</font>);<br>
&nbsp;&nbsp; Serial.println (WiFi_SSID);<br>
<br>
&nbsp;&nbsp; WiFi.begin (WiFi_SSID, WiFi_Password);<br>
<br>
&nbsp;&nbsp; <font color="#0000FF">while</font> (WiFi.status () != WL_CONNECTED)<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay (<font color="#800000">500</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print (<font color="#FF0000">&quot;.&quot;</font>);<br>
&nbsp;&nbsp; }<br>
&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot;Connected, IP address: &quot;</font>);<br>
&nbsp;&nbsp; Serial.println (WiFi.localIP ());<br>
}<br>
<br>
<font color="#0000FF">void</font> Reconnect_MQTT ()<br>
{<br>
&nbsp;&nbsp; <font color="#0000FF">while</font> (!MQTT_Client.connected ())<br>
&nbsp;&nbsp; {&nbsp; <font color="#008000">// Loop until we're reconnected</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print (<font color="#FF0000">&quot;Connecting 
to MQTT broker ...&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">if</font> (MQTT_Client.connect 
(<font color="#FF0000">&quot;ESP8266Client&quot;</font>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot;Connected&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MQTT_Client.subscribe (<font color="#FF0000">&quot;relay&quot;</font>);
<font color="#008000">// Subscribe to the topic</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print (<font color="#FF0000">&quot; 
failed to connect, rc=&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print (MQTT_Client.state 
());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println (<font color="#FF0000">&quot; 
try again in 5 seconds&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay (<font color="#800000">5000</font>);
<font color="#008000">// Wait 5 seconds before retrying</font><br>
&nbsp;&nbsp; }&nbsp; }<br>
}<br>
<br>
<font color="#0000FF">void</font> loop ()<br>
{&nbsp; <font color="#008000">// Main loop</font><br>
&nbsp;&nbsp; <font color="#0000FF">if</font> (!MQTT_Client.connected ())<br>
&nbsp;&nbsp; {&nbsp; <font color="#008000">// Connect to the MQTT broker</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reconnect_MQTT ();<br>
&nbsp;&nbsp; }<br>
&nbsp;&nbsp; MQTT_Client.loop (); <font color="#008000">// Pump network I/O</font><br>
}</tt></TD>
  </TR>
</TABLE>

<p>The program connects to the MAX! home automation MQTT broker and subscribes 
to the topic <i>relay</i>. When the payload is <i>on</i> the relay is set to 
closed, otherwise it is set to open. This is done by the command <i>digitalWrite</i>.</p>

<H3>5.5. <a name="5.5"></a>Controlling a boiler with a MAX! switch</H3>
<p>MAX! switch eQ-3 BC-TS-Sw-Pl, shown on the picture below</p>
<blockquote>
	<p><img border="0" src="max_switch.png" width="134" height="247" alt="MAX! switch"></p>
</blockquote>
<p>is a device that can be paired with the cube. No wall thermostat in the same 
room is required to control the switch.</p>
<p>In the overview the switch appears as a radiator thermostat. It has the schedule 
just like radiator and wall-mounted thermostats do with the effect that the set 
temperature controls switching it on and off:</p>
<ul>
	<li>25.0<font face="Times New Roman">C 
	turns the switch on;</font></li>
	<li><font face="Times New Roman">15.0C turns the switch off.</font></li>
</ul>
<p><font face="Times New Roman">The automatic mode schedule can be used for 
example for turning plant lights on and off. The same temperatures work in the 
manual mode too. This can be used for controlling a 
boiler. The following script illustrates the principle:</font></p>

<TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt><b><font color="#0000FF">import</font></b> elv_max_cube<br>
<b><font color="#0000FF">def </font></b>controller (*args):<br>
&nbsp;&nbsp; <font color="#0000FF">if</font> elv_max_cube.get_valve_statistics (<font color="#800000">0xBB8F0</font>) 
[<font color="#FF0000">&quot;average&quot;</font>] &gt; <font color="#800000">0.1</font>:<br>
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elv_max_cube.set_mode (mode=<font color="#FF0000">'manual'</font>, 
cube=<font color="#800000">0xBB8F0</font>, device=<font color="#800000">0x724EC</font>, temperature=<font color="#800000">25.0</font>)<br>
&nbsp;&nbsp; <font color="#0000FF">else</font>:<br>
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elv_max_cube.set_mode (mode=<font color="#FF0000">'manual'</font>, 
cube=<font color="#800000">0xBB8F0</font>, device=<font color="#800000">0x724EC</font>, temperature=<font color="#800000">15.0</font>)</tt></TD>
  </TR>
</TABLE>

<p><font face="Times New Roman">The script looks the average valve positions and 
if that is greater then 0.1 (10% open) it sets the manual mode temperature to
</font>25.0<font face="Times New Roman">C. Otherwise it sets it to15.0C. The 
sample code assumes the cube's RF address BB8F0 and 
the switch's address 724EC.</font></p>
<p><font face="Times New Roman">Another switching device which can be used this way is the 
MAX! boiler control actuator eQ-3 BC-TS-Sw2-WM:</font></p>
<blockquote>
	<p>
	<img border="0" src="max_boiler_control_actuator.png" width="196" height="283" alt="MAX! boiler control actuator"></p>
</blockquote>
<H3>5.6. <a name="5.6"></a>Julia scripting</H3>
<p>Simple control tasks can be performed by providing a 
<a href="https://julialang.org">Julia</a> script to be 
called periodically. The script can access the application through the module <i>
ELV_MAX_Cube</i>. 
The module is loaded as shown in the following example:</p><TABLE border="1" cellpadding="15" cellspacing="0">
  <TR>
<TD bgcolor="#FFFFCC"><tt><font color="#008000"># Minimal 
	controller script<br>
	</font><b><font color="#0000FF">function </font></b>controller ()<br>
&nbsp;&nbsp; ELV_MAX_Cube.trace (<font color="#FF0000">&quot;Hello 
	there!&quot;</font>)<br>
<font color="#0000FF">end</font></tt></TD>
  </TR>
</TABLE>
<p>The settings pane has Julia script settings:</p>
<blockquote>
	<H3>
	<img border="0" src="max-julia-script.png" alt="Julia script"></H3>
</blockquote>
<p>Here the fields are:</p>
<ul>
	<li><i>Julia library</i> is the dynamic library of the Julia interpreter. 
	If the library name is relative the path to it must be in the system library 
	path;</li>
	<li><i>Script file name</i> is the name of the script to execute;</li>
	<li><i>Invoke period</i> specifies how frequently the script must be 
	executed. This is the time to wait before next call of the script;</li>
	<li><i>Start delay</i> specifies the time before the first invocation of the 
	script. You want to make sure that the cube completes handshake procedure 
	before starting the script.</li>
</ul>
<p>Note that <a href="https://julialang.org">Julia</a> has no means to insulate effects of interpreting code. For 
this reason it is not possible to reload a script one it was loaded or attempted 
to load. If it is necessary to modify the script or loading error occurred, the 
application must be restarted before doing that.</p>
<H3>5.7. <a name="5.7"></a>Julia module ELV_MAX_Cube</H3>
<p>The following methods are provided by the module <i>ELV_MAX_Cube</i>:</p>
<table border="0" cellpadding="0" cellspacing="20">
<tr><td valign="top">
<a href="#ELV_MAX_Cube.disconnect">disconnect</a><br>
<a href="#ELV_MAX_Cube.get_battery">get_battery</a><br>
<a href="#ELV_MAX_Cube.get_connection">get_connection</a><br>
<a href="#ELV_MAX_Cube.get_cubes_list">get_cubes_list</a><br>
<a href="#ELV_MAX_Cube.get_devices_list">get_devices_list</a><br>
<a href="#ELV_MAX_Cube.get_duty">get_duty</a><br>
<a href="#ELV_MAX_Cube.get_link">get_link</a></td>
<td valign="top">
<a href="#ELV_MAX_Cube.get_mode">get_mode</a><br>
<a href="#ELV_MAX_Cube.get_mqtt_message">get_mqtt_message</a><br>
<a href="#ELV_MAX_Cube.get_parameters">get_parameters</a><br>
<a href="#ELV_MAX_Cube.get_set_temperature">get_set_temperature</a><br>
<a href="#ELV_MAX_Cube.get_status">get_status</a><br>
<a href="#ELV_MAX_Cube.get_summer_time">get_summer_time</a><br>
<a href="#ELV_MAX_Cube.get_temperature">get_temperature</a></td>
<td valign="top">
<a href="#ELV_MAX_Cube.get_valve">get_valve</a><br>
<a href="#ELV_MAX_Cube.get_valve_statistics">get_valve_statistic</a><br>
<a href="#ELV_MAX_Cube.publish_mqtt_message">publish_mqtt_message</a><br>
<a href="#ELV_MAX_Cube.reboot">reboot</a><br>
<a href="#ELV_MAX_Cube.reconnect">reconnect</a><br>
<a href="#ELV_MAX_Cube.set_mode">set_mode</a><br>
<a href="#ELV_MAX_Cube.trace">trace</a></td>
</tr>
</table>
<h4>5.7.1. disconnect</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.disconnect"></a>ELV_MAX_Cube.disconnect(<i>cube</i>::UInt32)</tt></p>
</blockquote>
<p>This method disconnects from the cube specified by the parameter <i>cube</i> 
which is the RF address of the cube. Note that the operation is asynchronous, 
the call only initiates disconnection. Exception is raised when no such cube 
exists.</p>
<h4>5.7.2. get_battery</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_battery"></a>ELV_MAX_Cube.get_battery(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the battery state by the RF address of the cube and the 
RF address of the device. The result is an enumeration declared as:</p>
<blockquote>
	<p><tt>@<font color="#0000FF">enum</font> Battery_Charge
	<font color="#0000FF">begin</font><br>
&nbsp;&nbsp; low=<font color="#800000">0</font><br>
&nbsp;&nbsp; high=<font color="#800000">1</font><br>
	<font color="#0000FF">end</font></tt></p>
</blockquote>
<p>Exception 
is raised when no device was found or it has no battery. For example the following code lists 
battery state of a device:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(string(<font color="#FF0000">&quot;Battery 
state: &quot;</font>,ELV_MAX_Cube.get_battery(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>))</tt></p>
</blockquote>
<h4>5.7.3. get_connection</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_connection"></a>ELV_MAX_Cube.get_connection(<i>cube</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns cube connection status. The parameter <i>cube</i> is the RF 
address of the cube. The result is an enumeration declared as:</p>
<blockquote>
	<p><tt>@<font color="#0000FF">enum</font> Connection_State
	<font color="#0000FF">begin</font><br>
&nbsp;&nbsp; connected=<font color="#800000">0</font><br>
&nbsp;&nbsp; disconnected=<font color="#800000">1</font><br>
&nbsp;&nbsp; undefined=<font color="#800000">2</font><br>
	<font color="#0000FF">end</font></tt></p>
</blockquote>
<p><i>unknown'</i>is returned when cube does not 
specify a known cube.</p>
<h4>5.7.4. get_cubes_list</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_cubes_list"></a>ELV_MAX_Cube.get_cubes_list()</tt></p>
</blockquote>
<p>This method returns the list of RF addresses as an array, one address for each detected 
cube.</p>
<h4>5.7.5. get_devices_list</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_devices_list"></a>ELV_MAX_Cube.get_devices_list(<i>cube</i>::UInt32,<i>filter::Vector{Device_Type}=Device_Type[]</i>)</tt></p>
</blockquote>
<p>This method returns the list of RF addresses of the devices managed by the 
cube and filtered by the type as an array. The parameter <i>cube</i> is the RF address of 
the cube. When 0 the devices are taken from any cube. <i>device_types</i> is the 
list of device types to accept. It has the type <i>Vector{Device_Type}</i> when
<i>Device_Type</i> is an enumeration declare as follows:</p>
<blockquote>
	<p><tt><a name="Julia.ELV_MAX_Cube.Device_Type"></a>@<font color="#0000FF">enum</font> 
	Device_Type <font color="#0000FF">begin</font><br>&nbsp;&nbsp; unknown=<font color="#800000">0</font><br>
&nbsp;&nbsp; cube=<font color="#800000">1</font><br>
&nbsp;&nbsp; radiator_thermostat=<font color="#800000">2</font><br>
&nbsp;&nbsp; radiator_thermostat_plus=<font color="#800000">3</font><br>
&nbsp;&nbsp; wall_thermostat=<font color="#800000">4</font><br>
&nbsp;&nbsp; shutter_contact=<font color="#800000">5</font><br>
&nbsp;&nbsp; eco_button=<font color="#800000">6</font> <br>
	<font color="#0000FF">end</font></tt></p>
</blockquote>
<p>Devices with the types appearing in the list are included in the result. The following example lists all radiator thermostats 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.get_devices_list(<font color="#800000">0x0BB8F0</font>,[ELV_MAX_Cube.radiator_thermostat,ELV_MAX_Cube.radiator thermostat_plus])</tt></p>
</blockquote>
<h4>5.7.6. get_duty</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_duty"></a>ELV_MAX_Cube.get_duty(<i>cube</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the duty of the cube 0.0..1.0. When the value reaches its 
maximum the cube stops sending anything and waits for an hour.</p>
<h4>5.7.7. get_link</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_link"></a>ELV_MAX_Cube.get_link(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the link state by the RF address of the cube and the RF 
address of the device. The result is an enumeration declared as follows:</p>
<blockquote>
	<p><tt>@<font color="#0000FF">enum</font> Link_State <font color="#0000FF">begin</font><br>&nbsp;&nbsp; 
	ok=<font color="#800000">0</font><br>
&nbsp;&nbsp; error=<font color="#800000">1</font><br>
	<font color="#0000FF">end</font></tt></p>
</blockquote>
<p>An exception is propagated 
when no device was found or it has no link state. For example the following code 
shows link state of a device:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(string(ELV_MAX_Cube.get_link(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.8. get_mode</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_mode"></a>ELV_MAX_Cube.get_mode(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the operating mode of a device specified by the RF address of the cube and the RF 
address of the device. The result is an enumeration declared as:</p>
<blockquote>
	<p><tt><a name="Julia.ELV_MAX_Cube.Operating_Mode"></a>@<font color="#0000FF">enum</font> 
	Operating_Mode <font color="#0000FF">begin</font><br>&nbsp;&nbsp; automatic=<font color="#800000">0</font><br>
&nbsp;&nbsp; manual=<font color="#800000">1</font><br>
&nbsp;&nbsp; boost=<font color="#800000">2</font><br>
&nbsp;&nbsp; vacation=<font color="#800000">3</font><br>
	<font color="#0000FF">end</font></tt></p>
</blockquote>
<p>An exception is propagated when no device was found or it has no mode. For example the following code lists 
the operating mode:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(string(<font color="#FF0000">&quot;Mode: &quot;</font>),string(ELV_MAX_Cube.get_mode(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.9. get_mqtt_message</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_mqtt_message"></a>ELV_MAX_Cube.get_mqtt_message(<i>topic</i>::AbstractString)</tt></p>
</blockquote>
<p>This method returns retained message from the MAX! home automation broker. 
The parameter <i>topic</i> specifies the message topic. When the topic is 
invalid or when no message exists an exception is raised. The 
following example illustrates getting topic <i>Greeting:</i></p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(string(<font color="#FF0000">&quot;Message: &quot;</font>),ELV_MAX_Cube.get_mqtt_message (<font color="#FF0000">&quot;Greeting&quot;</font>))</tt></p>
</blockquote>
<h4>5.7.10. get_parameters</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_parameters"></a>ELV_MAX_Cube.get_parameters(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns a named tuple describing parameters of&nbsp; <i>device</i> 
handled by <i>cube</i>. The tuple contains the following keys some of which 
can be absent depending on the device type, its order can differ as well:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">address</TD>
    <TD align="center" valign="top"> UInt32</TD>
    <TD align="left" valign="top"> The RF-address of the device</TD>
  </tr>
	<tr>
    <TD valign="top">airing_temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat room airing temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">airing_mode_delay</TD>
    <TD align="center" valign="top"> Dates.Time</TD>
    <TD align="left" valign="top"> The duration</TD>
  </tr>
	<tr>
    <TD valign="top">boost_duration</TD>
    <TD align="center" valign="top"> Dates.Time</TD>
    <TD align="left" valign="top"> The duration of the thermostat boost mode</TD>
  </tr>
	<tr>
    <TD valign="top">boost_valve_position</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The valve position in the boost mode in the 
	range 0..1. 1 corresponds to a fully open valve</TD>
  </tr>
	<tr>
    <TD valign="top">comfort_temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat comfort temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">decalcification_time</TD>
    <TD align="center" valign="top"> Tuple</TD>
    <TD align="left" valign="top"> The week day and time to perform the 
	procedure. The value is a tuple of two elements:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD align="center" valign="top"> <a href="#Julia.ELV_MAX_Cube.Week_Day">Week_Day</a></TD>
    <TD align="left" valign="top"> The day of week. The Week_Day is an 
	enumeration declared in the module as follows:<blockquote>
		<p><tt><a name="Julia.ELV_MAX_Cube.Week_Day"></a>@<font color="#0000FF">enum</font> 
		Week_Day <font color="#0000FF">begin</font><br>&nbsp;&nbsp; Mo=<font color="#800000">1</font><br>
&nbsp;&nbsp; Tu=<font color="#800000">2</font><br>
&nbsp;&nbsp; We=<font color="#800000">3</font><br>
&nbsp;&nbsp; Th=<font color="#800000">4</font><br>
&nbsp;&nbsp; Fr=<font color="#800000">5</font><br>
&nbsp;&nbsp; Sa=<font color="#800000">6</font><br>
&nbsp;&nbsp; Su=<font color="#800000">7</font><br>
		<font color="#0000FF">end</font></tt></p>
	</blockquote>
	</TD>
  </tr>
	<tr>
    <TD align="center" valign="top"> Dates.Time</TD>
    <TD align="left" valign="top"> The time</TD>
  </tr>
  </TABLE>

		</TD>
  </tr>
	<tr>
    <TD valign="top">eco_temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat eco temperature, when in the 
	'eco' mode (Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">maximum_valve_position</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat maximum valve position in the 
	range 0..1. 1 corresponds to a fully open valve</TD>
  </tr>
	<tr>
    <TD valign="top">maximum_temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat maximal temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">minimum_temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat minimum temperature 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">room</TD>
    <TD align="center" valign="top"> AbstractString</TD>
    <TD align="left" valign="top"> The device's room name</TD>
  </tr>
	<tr>
    <TD valign="top">room_id</TD>
    <TD align="center" valign="top"> UInt8</TD>
    <TD align="left" valign="top"> The ID number of the device's room</TD>
  </tr>
	<tr>
    <TD valign="top">name</TD>
    <TD align="center" valign="top"> AbstractString</TD>
    <TD align="left" valign="top"> The device name</TD>
  </tr>
	<tr>
    <TD valign="top">schedule</TD>
    <TD align="center" valign="top"> NamedTuple</TD>
    <TD align="left" valign="top"> The thermostat schedule in the automatic 
	mode. It is a named tuple with the keys '<i>Mo</i>', '<i>Tu</i>', '<i>We</i>', 
	'<i>Th</i>', '<i>Fr</i>', '<i>Sa</i>', '<i>Su</i>'. The values of the tuple 
	are of the type <i>Vector</i>. The elements of the vector are tuples of two 
	items:<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD align="center" valign="top"> Dates.Time</TD>
    <TD align="left" valign="top"> The time until the 
	specified temperature must be held</TD>
  </tr>
	<tr>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The set temperature in Centigrade</TD>
  </tr>
	</TABLE>

	</TD>
  </tr>
	<tr>
    <TD valign="top">serial_no</TD>
    <TD align="center" valign="top"> AbstractString</TD>
    <TD align="left" valign="top"> The device serial number</TD>
  </tr>
	<tr>
    <TD valign="top">temperature_offset</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The thermostat temperature offset 
	(Centigrade)</TD>
  </tr>
	<tr>
    <TD valign="top">type</TD>
    <TD align="center" valign="top"> <a href="#Julia.ELV_MAX_Cube.Device_Type">
	Device_Type</a></TD>
    <TD align="left" valign="top">  

The device type</TD>
  </tr>
  <TR>
    <TD valign="top">valve_offset</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The value 1.0 corresponds to a fully 
	open valve</TD>
  </TR>
  </TABLE>

<p>An exception is propagated when no device was found. The following example illustrates 
tracing state of the thermostat 0B76DA 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Parameters &quot;</font>,string(ELV_MAX_Cube.get_parameters(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.11. get_set_temperature</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_set_temperature"></a>ELV_MAX_Cube.get_set_temperature(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This function returns the current set temperature by the RF address of the 
cube and the RF address of the device. The result is the temperature is Float32 in 
Centigrade. The set temperature is used to control the radiator. An exception is 
propagated when no device was found or it has no temperature. 
For example the following code lists the set temperature:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Set temperature: &quot;</font>,string(ELV_MAX_Cube.get_set_temperature(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.12. get_status</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_status"></a>ELV_MAX_Cube.get_status(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns a named tuple describing status of&nbsp; <i>device</i> 
handled by <i>cube</i>. The tuple contains the following keys some of which 
as well as the order can be absent depending on the device type:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">address</TD>
    <TD align="center" valign="top"> UInt32</TD>
    <TD align="left" valign="top"> The RF-address of the device</TD>
  </tr>
	<tr>
    <TD valign="top">battery low</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if battery is low</TD>
  </tr>
	<tr>
    <TD valign="top">error</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if error</TD>
  </tr>
	<tr>
    <TD valign="top">initialized</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if initialized</TD>
  </tr>
	<tr>
    <TD valign="top">link error</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if link error</TD>
  </tr>
	<tr>
    <TD valign="top">mode</TD>
    <TD align="center" valign="top"> 
	<a href="#Julia.ELV_MAX_Cube.Operating_Mode">Operating_Mode</a></TD>
    <TD align="left" valign="top">  

The operating mode of the device</TD>
  </tr>
	<tr>
    <TD valign="top">new temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The new temperature for the thermostat. It 
	differs from the above if the thermostat is not yet aware of the change</TD>
  </tr>
	<tr>
    <TD valign="top">open</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if shutter contact is open</TD>
  </tr>
	<tr>
    <TD valign="top">panel locked</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if locked</TD>
  </tr>
	<tr>
    <TD valign="top">set temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The temperature kept by the thermostat</TD>
  </tr>
	<tr>
    <TD valign="top">summer time</TD>
    <TD align="center" valign="top"> Bool</TD>
    <TD align="left" valign="top"> True if summer time</TD>
  </tr>
	<tr>
    <TD valign="top">temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The actual room temperature, if known</TD>
  </tr>
	<tr>
    <TD valign="top">type</TD>
    <TD align="center" valign="top"> <a href="#Julia.ELV_MAX_Cube.Device_Type">
	Device_Type</a></TD>
    <TD align="left" valign="top">  

The device type</TD>
  </tr>
  <TR>
    <TD valign="top">valve</TD>
    <TD align="center" valign="top"> float</TD>
    <TD align="left" valign="top"> The value 1.0 corresponds to a fully 
	open valve</TD>
  </TR>
  </TABLE>

<p>An exception is propagated when no device was found. The following example illustrates 
tracing state of the thermostat 0B76DA&nbsp; 
managed by the the cube with the address 0BB8F0:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Status &quot;</font>,string(ELV_MAX_Cube.get_status(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.13. get_summer_time</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_summer_time"></a>
	ELV_MAX_Cube.get_summer_time(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This function&nbsp; returns the daytime saving mode of device specified by the RF 
address of the cube and the RF address of the device as Bool. True is he result when the 
summer time is active. An exception is propagated when no device was found or it has no time 
mode settings. For example the following code shows the active daytime saving 
mode:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Summer time: &quot;</font>,string(ELV_MAX_Cube.get_summer_time(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.14. get_temperature</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_temperature"></a>ELV_MAX_Cube.get_temperature(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the current measured temperature by the RF address of the 
cube and the RF address of the device. The result is the measured temperature in 
Centigrade of the type Float32. An exception is propagated when no device was found, it has no temperature or when the temperature is 
yet unknown. For example the following code lists 
the measured temperature:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Temperature: &quot;</font>,string(ELV_MAX_Cube.get_temperature(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.15. get_valve</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_valve"></a>ELV_MAX_Cube.get_valve(<i>cube</i>::UInt32,<i>device</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the valve position of a thermostat specified by the RF address of the 
cube and the RF address of the device. The result is in the range 0..1 of the 
type Float32. The 
value 1 corresponds to a fully open valve. An exception is propagated when no device was found or it 
is not a thermostat. For example the following code shows the valve position of 
a thermostat:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace(<font color="#FF0000">&quot;Valve: &quot;</font>,string(ELV_MAX_Cube.get_valve(<font color="#800000">0x0BB8F0</font>,<font color="#800000">0x0B76DA</font>)))</tt></p>
</blockquote>
<h4>5.7.16. get_valve_statistics</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.get_valve_statistics"></a>ELV_MAX_Cube.get_valve_statistics(<i>cube</i>::UInt32)</tt></p>
</blockquote>
<p>This method returns the statistics of the current thermostat valve positions 
as a named tuple. 
The parameter <i>cube</i> is the RF address of the 
cube which thermostats are queried. The result is a tuple described below:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">average</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The average valve position in the range 0..1</TD>
  </tr>
	<tr>
    <TD valign="top">maximum</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The maximal valve position in the range 0..1</TD>
  </tr>
	<tr>
    <TD valign="top">minimum</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The minimal valve position in the range 0..1</TD>
  </tr>
	</TABLE>

<p>The valve position is in the range 0..1. The value 1 corresponds to a fully 
open valve. When there is no thermostats corresponding, the returned fields are 
0.</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.trace (<font color="#FF0000">&quot;Average 
valve position: &quot;</font>,string(ELV_MAX_Cube.get_valve_statistics(<font color="#800000">0x0BB8F0</font>).Average))</tt></p>
</blockquote>
<h4>5.7.17. publish_mqtt_message</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.publish_mqtt_message"></a>ELV_MAX_Cube.publish_mqtt_message(<i>topic</i>::AbstractString,<i>message</i>::AbstractString,<i>policy</i>::MQTT_Policy<i>=</i>updated)</tt></p>
</blockquote>
<p>This method publishes <i>topic</i> with the message specified by <i>message</i>&nbsp; the statistics of the current thermostat valve positions. 
The parameter <i>policy</i> has the following enumeration type:</p>
<blockquote>
	<p><tt>@<font color="#0000FF">enum</font> MQTT_Policy <font color="#0000FF">begin</font><br>&nbsp;&nbsp; 
	transient=<font color="#800000">0</font><br>
&nbsp;&nbsp; retained=<font color="#800000">1</font><br>
&nbsp;&nbsp; updated=<font color="#800000">2</font><br>
&nbsp;&nbsp; initial=<font color="#800000">3</font><br>
&nbsp;&nbsp; ignored=<font color="#800000">4</font> <br><font color="#0000FF">end</font></tt></p>
</blockquote>
<p>is specifies how to handle the message:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Policy</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Description</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">transient</TD>
    <TD align="left" valign="top"> The message is not retained, only active 
	subscriptions get it</TD>
  </tr>
	<tr>
    <TD valign="top">retained</TD>
    <TD align="left" valign="top"> The message always replaces the retained one</TD>
  </tr>
	<tr>
    <TD valign="top">updated</TD>
    <TD align="left" valign="top"> Ignored if same as the retained one, 
	otherwise it replaces the old one. This is the default</TD>
  </tr>
	<tr>
    <TD valign="top">initial</TD>
    <TD align="left" valign="top"> Ignored if already retained</TD>
  </tr>
	<tr>
    <TD valign="top">ignored</TD>
    <TD align="left" valign="top"> The message is ignored</TD>
  </tr>
	</TABLE>

<p>The following example illustrates publishing topic <i>Greeting</i> with the 
message <i>Hi!</i></p>
<blockquote>
	<p><tt>ELV_MAX_Cube.publish_mqtt_message(<font color="#FF0000">&quot;Greeting&quot;</font>,<font color="#FF0000">&quot;Hi!&quot;</font>)</tt></p>
</blockquote>

<h4>5.7.18. reboot</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.reboot0"></a>ELV_MAX_Cube.reboot(<i>cube</i>::AbstractString)</tt></p>
</blockquote>
<p>This method is used to reboot a cube. The cube is identified by it 
10-characters serial number. 
There is no return value.</p>

<h4>5.7.19. reconnect</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.reconnect"></a>ELV_MAX_Cube.reconnect(<i>cube</i>::UInt32)</tt></p>
</blockquote>
<p>This method reconnects to the cube specified by the parameter <i>cube</i> 
which is the RF address of the cube. Note that the operation is asynchronous, 
the call only initiates reconnection. A exception is propagated when no such cube 
exists.</p>
<h4>5.7.20. set_mode</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.set_mode"></a>ELV_MAX_Cube.set_mode(<i>mode::Operating_Mode</i>,<i><br>
	cube</i>::UInt32,<i><br>
	device</i>::UInt32=0,<i><br>
	temperature=::Float32=0.0f0,<br>
	disposition::Temperature_Disposition=absolute,<br>
	until::Dates.DateTime=Dates.DateTime(2020)</i>)</tt></p>
</blockquote>
<p>This method sets one or several thermostats into the specified mode. The 
method takes keyed parameters with the names given in the following table:</p>

<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Key</b></font></TD>
    <TD bgcolor="#008080" align="center"> <font color="#FFFFFF"><b>Type</b></font></TD>
    <TD bgcolor="#008080" align="left"> <font color="#FFFFFF"><b>Contents</b></font></TD>
  </TR>
	<tr>
    <TD valign="top">mode</TD>
    <TD align="center" valign="top">  
	<a href="#Julia.ELV_MAX_Cube.Operating_Mode">Operating_Mode</a></TD>
    <TD align="left" valign="top"> The thermostat mode to set</TD>
  </tr>
	<tr>
    <TD valign="top">cube</TD>
    <TD align="center" valign="top"> UInt32</TD>
    <TD align="left" valign="top"> The RF address of the cube of which 
	thermostats must be set</TD>
  </tr>
	<tr>
    <TD valign="top">device</TD>
    <TD align="center" valign="top"> UInt32</TD>
    <TD align="left" valign="top"> The RF address of the thermostat to set. This 
	parameter is optional. Then absent the mode is set into all thermostats of 
	the cube. The parameter key can be either <i>device</i> or <i>thermostat</i>.</TD>
  </tr>
	<tr>
    <TD valign="top">temperature</TD>
    <TD align="center" valign="top"> Float32</TD>
    <TD align="left" valign="top"> The temperature in Centigrade. This parameter 
	is optional if the temperature is not required or specified by other means. 
	When required but not specified an exception is propagated. The temperature is 
	either absolute or relative to the current temperature as specified by the 
	parameter <i>disposition</i>.</TD>
  </tr>
	<tr>
    <TD valign="top">disposition</TD>
    <TD align="center" valign="top"> 
	<a href="#Julia.ELV_MAX_Cube.Temperature_Disposition">
	Temperature_Disposition</a></TD>
    <TD align="left" valign="top"> The parameter specifies how to treat the 
	temperature parameter. It has the enumeration type declared as follows:<blockquote>
		<p><tt><a name="Julia.ELV_MAX_Cube.Temperature_Disposition"></a>@<font color="#0000FF">enum</font> 
		MQTT_Policy <font color="#0000FF">begin</font><br>&nbsp;&nbsp; absolute=<font color="#800000">0</font><br>
&nbsp;&nbsp; airing=<font color="#800000">1</font><br>
&nbsp;&nbsp; comfort=<font color="#800000">2</font><br>
&nbsp;&nbsp; decrement=<font color="#800000">3</font><br>
&nbsp;&nbsp; eco=4<br>
&nbsp;&nbsp; increment=<font color="#800000">5 </font><br><font color="#0000FF">end</font></tt></p>
	</blockquote>
	<p>The meaning of the values is described below:</p>
	<TABLE border="5" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Disposition</b></font></TD>
    <TD valign="top" bgcolor="#008080"><font color="#FFFFFF"><b>Meaning</b></font></TD>
  </TR>
  <TR>
    <TD valign="top">absolute</TD>
    <TD valign="top">The value of the parameter temperature is used as-is for 
	the mode to set. The <i>temperature</i> parameter must be present, otherwise 
	an exception is propagated. This is the default when the <i>temperature</i> 
	parameter is specified.</TD>
  </TR>
  <tr>
    <TD valign="top">airing</TD>
    <TD valign="top">The airing mode temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise an exception&nbsp; is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">comfort</TD>
    <TD valign="top">The comfort temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise an exception is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">decrement</TD>
    <TD valign="top">The value of the parameter temperature is used to decrement 
	the current temperature, the result is used for the mode. The <i>temperature</i> 
	parameter must be present, otherwise an exception is raised.</TD>
  </tr>
	<tr>
    <TD valign="top">eco</TD>
    <TD valign="top">The eco temperature is used for the mode. The <i>
	temperature</i> parameter must be absent, otherwise an exception is raised.</TD>
  </tr>
  <TR>
    <TD valign="top">increment</TD>
    <TD valign="top">The value of the parameter temperature is used to increment 
	the current temperature, the result is used for the mode. The <i>temperature</i> 
	parameter must be present, otherwise an exception is raised.</TD>
  </TR>
  	</TABLE></TD>
  </tr>
	<tr>
    <TD valign="top">until</TD>
    <TD align="center" valign="top"> Dates.DateTime</TD>
    <TD align="left" valign="top"> The date and time of the vacation end. This 
	parameter must appear when the mode is <i>vacation</i>. It must be absent 
	for any other mode, otherwise an exception is raised.</TD>
  </tr>
	</TABLE>

<p>The method is asynchronous. It only initiates setting the mode, which can 
take a considerable time or fail when the RF traffic is exhausted. The following 
example sets all thermostats to automatic mode:</p>
<blockquote>
	<p><tt>ELV_MAX_Cube.set_mode(ELV_MAX_Cube.automatic,<font color="#800000">0x0BB8F0</font>)</tt></p>
</blockquote>
<h4>5.2.21. trace</h4>
<blockquote>
	<p><tt><a name="ELV_MAX_Cube.trace"></a>ELV_MAX_Cube.trace(<i>message</i>::AbstractString)</tt></p>
</blockquote>
<p>This method sends the argument message to the application's trace panel. 
There is no return value.</p>

<hr>
<p align="right">
  <A name="6"></A><a href="#5">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#7"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>6. Running headless and other issues</H2>
<H3>6.1. <a name="6.1"></a>Headless</H3>
<p>In order to run the application headless under Linux use the following 
command (bash):</p>
<blockquote>
	<p><tt>&gt;xvfb-run -a max_home_automation</tt></p>
</blockquote>
<p>Here Xvfb is X virtual frame buffer, an X11 server that uses memory instead 
of a physical display. You might need to install it on your system if the 
package <i>xvfb</i> is not 
there.</p>
<H3>6.2. <a name="6.2"></a>Running remotely</H3>
<p>Before running the application headless you might wish to change some 
settings or monitor how things work in general. You can run it remotely using the PC's X11 
local server as the display for the remotely running program.</p>
<p><u><b>Linux</b></u>. Under Linux you use SSH with X11 forwarding. The 
command line looks like follows:</p>
<blockquote>
	<p><tt>&gt;ssh -X -v <font color="#FF0000">&lt;user&gt;</font>@<font color="#FF0000">&lt;host&gt;</font> max_home_automation</tt></p>
</blockquote>
<p>Here <tt><font color="#FF0000">&lt;user&gt;</font></tt> is the user you want 
to log in and <tt><font color="#FF0000">&lt;host&gt;</font></tt> is the address 
or name of the machine where you want to run it, e.g. on your headless Raspberry 
PI. On the other side you must have the SSH daemon running.</p>
<p><u><b>Windows</b></u>. Under Windows you need an X11 server and SSH client. 
There is a software that combines both: <a href="http://mobaxterm.mobatek.net/">
MobaXterm</a>. Under <a href="http://mobaxterm.mobatek.net/">MobaXterm</a> you 
can configure an SSH session with X11 forwarding.</p>
<H3>6.3. <a name="6.3"></a>Permission denied</H3>
<p>When you get error 13 permission denied upon HTTP start, that is because 
you lack permissions to bind the socket to the port 80. Usually only <i>root</i> 
can use ports with numbers below 1024 while the default HTTP port is 80. You may use another 
port or else run the software as <i>root</i>.</p>
<H3>6.4. <a name="6.4"></a>Settings file</H3>
<p>The settings are kept in the GTK recent manager file named <i>*.xbel</i>. The file location 
depends on the OS, usually it is where other user specific files are. E.g. under 
Windows it is <i>C:\Users\&lt;user-name&gt;\AppData\Local\recently-used.xbel</i>. The 
file has XML format. The file contains data of all GTK applications, not only 
ones of MAX! home automation.</p>
<p>The settings related to MAX! home automation can be exported into a separate 
text file using the button at the bottom of the settings pane. The file lines 
have the format:</p>
<blockquote>
	<p><tt><font color="#FF0000">&lt;setting&gt;</font>=&quot;<font color="#FF0000">&lt;value&gt;</font>&quot;</tt></p>
</blockquote>
<p>It is one line per setting. When the value contains quotation marks (&quot;), they 
are doubled. The file can also contain comment lines starting with <tt>--</tt>. 
Note that defaulted settings are not exported, only ones actually changed from 
the default value and in effect are. Here is an example of exported the settings 
file:</p>
<blockquote>
	<p><tt>----------------------------- Created 2019-12-07 12:00 
	-----------------------------<br>
	-- The file contains settings that are different from the defaults.<br>
	cors-max-age=&quot;86400&quot;<br>
	cors-headers=&quot;X-PINGOTHER, Content-Type&quot;<br>
	cors-methods=&quot;POST, GET, OPTIONS&quot;<br>
	cors-origin=&quot;&quot;<br>
	http-port=&quot;80&quot;<br>
	http-address=&quot;&quot;<br>
	host=&quot;&quot;<br>
	height=&quot;978&quot;<br>
	width=&quot;985&quot;<br>
	y=&quot;104&quot;<br>
	x=&quot;670&quot;<br>
	mqtt-max-connections=&quot;100&quot;<br>
	mqtt-max-subscriptions=&quot;1&quot;<br>
	poll=&quot;10.0&quot;</tt></p>
</blockquote>
<p>In order to restore previously exported settings MAX! home automation is 
started with the option <tt>--restore</tt> specified in the command line:</p>
<blockquote>
	<p><tt>&gt;max_home_automation --restore=<font color="#FF0000">&lt;exported-settings-file&gt;</font></tt></p>
</blockquote>
<p>This will remove all existing settings related to MAX! home automation and 
put ones from the file instead. This is done before the program starts so that 
settings have the effect on.</p>
<H3>6.5. <a name="6.5"></a>dbind-WARNING</H3>
<p>On Debian or Ubuntu ARM target you may have get messages like:</p>
<blockquote>
	<p><tt>(max_home_automation:<font color="#808080">1722</font>): dbind-WARNING 
	**: <font color="#808080">17:36:59.591</font>: Error retrieving 
	accessibility bus address: org.freedesktop.DBus.Error.ServiceUnknown: The 
	name org.a11y.Bus was not provided by any .service files</tt></p>
</blockquote>
<p>In order to fix these install the package <i>at-spi2-core</i>:</p>
<blockquote>
	<p><tt>&gt;apt install at-spi2-core</tt></p>
</blockquote>
<H3>6.6. <a name="6.6"></a>Styles, languages, icons etc</H3>
<p>The appearance of the program graphical elements depends on the current GTK 
theme and styles. This includes texts that appear in the program as labels and 
tooltips. Such texts are defined as style properties. Some of the icons and 
pictures are embedded and cannot be changed altering the theme, otherwise an icon of any button is 
defined in the current theme.</p>
<p>For changing the GTK, please, refer to the official GTK documentation. The 
default GTK styles can be modified for the given user globally by creating and 
editing a CSS file. CSS stands for <b>C</b>ascading <b>
S</b>tyle <b>S</b>heets. The file is:</p>
<ul>
	<li>Under Windows<i>: %LOCALAPPDATA%\gtk-3.0\gtk.css</i></li>
	<li>Under Linux: <i>$HOME/.config/gtk-3.0<span lang="en-us">/</span>gtk.css</i></li>
</ul>
<p>Note that these style settings will be shared by all GTK programs.</p>
<p>If file <i>max_home_automation.css</i> exists in the working directory it 
will be loaded upon start. Additionally to that a custom CSS file can be 
explicitly loaded using the option <tt>--load-css</tt> specified in the command line:</p>
<blockquote>
	<p><tt>&gt;max_home_automation --load-css=<font color="#FF0000">&lt;custom-css-file&gt;</font></tt></p>
</blockquote>
<p>When no option <tt>--load-css</tt> specified the program attempts to load 
file names <i>max_home_automation.css</i> from the working directory if it 
exists.</p>
<H3>6.7. <a name="6.7"></a>CSS file template</H3>
<p>The number of styles is immense. They can be enumerated and exported into a 
CSS file supplied with current values using the button <i>Export CSS</i> at the 
bottom of the settings pane. Parts which need to be changed can be moved to one 
of the CSS files described above.</p>
<p>The following sample illustrates how to use CSS. It changes texts the first 
two labels of the tabs pane and the icon for the first button:</p>
<blockquote>
	<p><tt>label<br>{<br>&nbsp;&nbsp;
-MAX_Overview_label-label: &quot;Zusammenfassung&quot;;<br>&nbsp;&nbsp;
-MAX_Trace_label-label: &quot;Spur&quot;;<br>}<br>
	button<br>
	{<br>
&nbsp;&nbsp; -Add_Buttons-icon-id: &quot;gtk-open&quot;;<br>
	}</tt></p>
</blockquote>
<hr>
<p align="right">
  <A name="7"></A><a href="#6">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG
      src="index.gif" alt="[TOC]" width="29" height="29"></a><a href="#8"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>7. Building from sources</H2>
<p>The program uses
<a href="http://www.dmitry-kazakov.de/ada/components.htm">Simple Components for 
Ada</a>, <a href="http://www.dmitry-kazakov.de/ada/gtkada_contributions.htm">
GtkAda contributions</a> which are distributed with it. In order to compile it,
<a href="http://docs.adacore.com/gtkada-docs/gtkada_rm/gtkada_rm/">GtkAda</a> must be installed first.
Then with <a href="http://libre.adacore.com/libre/">GNAT compiler</a> it can be built using the following command:</p>
<blockquote>
	<p><tt>&gt;gprbuild -XDevelopment=Release -p -P max_home_automation.gpr</tt></p>
</blockquote>
<p>issued in the directory containing the sources. Additionally depending on the 
target the following scenario variables are set:</p>
<ul>
	<li><tt>-Xodbc=unixODBC</tt> on Linux targets, for Windows the value is <tt>ODBC32;</tt></li>
	<li><tt>-XTarget_OS=Linux</tt> on Linux targets, for Windows the value is <tt>
	Windows_NT;</tt></li>
	<li><tt>-XAtomic_Access=Pragma_Atomic</tt> and <tt>-Xarch=x86_64</tt> on 64-bit targets. 
	Other values for <tt>arch</tt> are <tt>i686</tt> and&nbsp; <tt>armhf</tt>. 
	On 32-bit platforms use <tt>-XAtomic_Access=GCC-long-offset.</tt> </li>
</ul>
<p>For example building on Windows 64-bit:</p>
<blockquote>
	<p><tt>&gt;gprbuild -XDevelopment=Release<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -XAtomic_Access=Pragma-atomic<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Xarch=x86_64<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -p -P max_home_automation.gpr</tt></p>
</blockquote>
<p>For example building on a Linux 64-bit:</p>
<blockquote>
	<p><tt>&gt;gprbuild -XDevelopment=Release<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -XAtomic_Access=Pragma-atomic<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Xarch=x86_64<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Xodbc=unixODBC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -XTarget_OS=Linux<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -p -P max_home_automation.gpr</tt></p>
</blockquote>
<p>Building on an ARM Linux 32-bit:</p>
<blockquote>
	<p><tt>&gt;gprbuild -XDevelopment=Release<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -XAtomic_Access=GCC-long-offsets<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Xarch=armhf<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Xodbc=unixODBC<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -XTarget_OS=Linux<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -p -P max_home_automation.gpr</tt></p>
</blockquote>
<p>You can also use the <i>max_home_automation.gpr</i> project with the <a href="https://libre.adacore.com/gps/main.html">
GPS</a> and compile it from there selecting scenarios described above.</p>
<hr>
<p align="right">
  <a name="8"></a><a href="#7">
	<IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG src="index.gif"
      alt="[TOC]" width="29" height="29"><IMG src="next.gif" alt="[Next]" width="29" height="29"></a></p>
<H2>8. <a name="changes_log"></a>Changes log</H2>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT Studio Community 2020 (20200427)</i></li>
	<li>
<i>GNAT Community 2019 (20190517-83)</i></li>
  <li>
<i>GNAT Community 2018 (20180523-73)</i></li>
	<li><i>GNAT 8-12</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.15</i></li>
	<li><i>GtkAda April 5, 2022 (GTK 3.24.33)</i></li>
</ul>
<P>Changes (19 January&nbsp;2025) to the version 4.9:</p>
<ul>
	<li>The oscilloscope graph <i>T<sub>set</sub></i> + <i>Offset</i> was 
	changed to <i>T<sub>set</sub></i> - <i>Offset</i>.</li>
</ul>
<P>Changes (18 December 2023) to the version 4.8:</p>
<ul>
	<li>Exporting styles fixed for the notebook titles.</li>
</ul>
<P>
Changes (30 September 2023) to the version 4.7:<ul>
	<li>The device status polling continues even if some the cube lost 
	configuration of some devices<span lang="en-us">;</span></li>
	<li><span lang="en-us">Resilience in presence of malconfigured devices 
	improved.</span></li>
	</ul>
<P>
Changes (24 June 2023) to the version 4.6:<ul>
	<li>MQTT .../status/.../json topics added;</li>
	<li>MQTT broker supports forceful publishing option on the settings page.</li>
	</ul>
<P>
Changes (22 April 2023) to the version 4.5:<ul>
	<li>MQTT topics added for Initialize and Panel_Locked;</li>
	<li>MQTT topics added for Eco button.</li>
	</ul>
<P>
Changes (5 August 2022) to the version 4.4:<ul>
	<li>Python scripting based to the bindings provided by the Simple Components 
	library.</li>
	</ul>
<P>
Changes (22 May 2022) to the version 4.3:<ul>
	<li>Adapted to GNAT 12.1 and Fedora 36.</li>
	</ul>
<P>
Changes (16 April 2022) to the version 4.2:<ul>
	<li>Built with the updated Simple Components library version 4.62.</li>
	</ul>
<P>
Changes (16 April 2022) to the version 4.1:<ul>
	<li>GNAT Studio Community 2021 bugs worked around;</li>
	<li>GTK 3.24.x support.</li>
	</ul>
<P>
Changes (29 January&nbsp;2022) to the version 4.0:<ul>
	<li>The bug &quot;Unsuccessful attempt to rename device&quot; fix while the device 
	renaming. The fix also affected other operations involving storing the 
	topology into the cube;</li>
	<li>MQTT wildcard subscription bug fixed.</li>
	</ul>
<P>
Changes (6 November&nbsp; 2021) to the version 3.29:<ul>
	<li>Julia scripting support was added;</li>
	<li><span lang="en-us">Summer time zone setting corrected;</span></li>
	<li><span lang="en-us">Workarounds added for the time zone interval 
	functions bugs in the Windows GLib port</span>.</li>
	</ul>
<P>
Changes (13 September 2021) to the version 3.28:<ul>
	<li>Not saving <i>temperature-timeout</i> was fixed.</li>
	</ul>
<P>
Changes (10 July 2021) to the version 3.27:<ul>
	<li>Switched to the latest version of Simple Components 4.58.</li>
	</ul>
<P>
Changes (12 June 2021) to the version 3.26:<ul>
	<li>Bug fix for large device configurations.</li>
	</ul>
<P>
Changes (2 May 2021) to the version 3.25:<ul>
	<li>A work around cube firmware problems added to prevent cube crashes when 
	sending configuration commands.</li>
	</ul>
<P>
Changes (3 April 2021) to the version 3.24:<ul>
	<li>The HTTP server response for <i>get-status-json</i> content type changed 
	to <i>application/json</i>;</li>
	<li>The HTTP<i> get-status-json</i> response was extended with the <i>offset</i> 
	value for the wall thermostats;</li>
	<li>The cube reboot via HTTP rest API fixed.</li>
	</ul>
<P>
Changes (21 February 2021) to the version 3.23:<ul>
	<li>Configuration saving bug fixed.</li>
	</ul>
<P>
Changes (14 February 2021) to the version 3.22:<ul>
	<li>24:00 made allowed in the syntax of thermostat day schedule;</li>
	<li>Schedule upload optimization added for MQTT and HTTP REST API;</li>
	<li>Offset and airing temperature were added for wall-mounted 
	thermostats.</li>
	</ul>
<P>
Changes (24 January 2021) to the version 3.21:<ul>
	<li>Configuration save/load dialog fixed;</li>
	<li>Added set-temperature graphs to the monitor pane;</li>
	<li>Added is- and set-temperature indicators to the monitor pane;</li>
	<li>Minor bug fixes.</li>
	</ul>
<P>
Changes (13 January 2021) to the version 3.20:<ul>
	<li>The number of preset buttons was increased to 10;</li>
	<li>MAX! cube exchange tracing enabling/disabling added;</li>
	<li>File saving dialog adds file extension from the selected file filter;</li>
	<li>The cube reboot button added;</li>
	<li>Reboot topic added to the MQTT server;</li>
	<li>Reboot REST API added to the HTTP server;</li>
	<li>Reboot method was added to the Python module.</li>
	</ul>
<P>
Changes (13 December 2020) to the version 3.19:<ul>
	<li>Configurable preset buttons added on the overview pane. The buttons 
	can be configured to set a selected number of thermostats into desired modes 
	by pressing the button;</li>
	<li>Popup menu added on the mouse right click.</li>
	</ul>
<P>
Changes (18 October 2020) to the version 3.18:<ul>
	<li>Ubuntu MQTT server connection error fixed (per GCC 10.0.1 bug 
	work-around).</li>
	</ul>
<P>
Changes (1 September 2020) to the version 3.17:<ul>
	<li>Legacy configuration file loading bug fixed;</li>
	<li>Time zone handing under Windows 7 fixed to work around its dealing with 
	RTZ (Russian Time Zone).</li>
	</ul>
<P>
Changes (2 June 2020) to the version 3.16:<ul>
	<li>Daylight saving time zone settings bug fixed.</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT Community 2019 (20190517-83)</i></li>
	<li>
<i>GNAT Community 2018 (20180523-73)</i></li>
	<li>
<i>GNAT 8</i></li>
	<li>
<i>GNAT 9</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.15</i></li>
	<li><i>GtkAda 2019</i></li>
</ul>
<P>
Changes (7 May 2020) to the version 3.15:<ul>
	<li>Built for Fedora 32.</li>
	</ul>
<P>
Changes (11 March 2020) to the version 3.14:<ul>
	<li>Double click on the thermostat opens its configuration panel;</li>
	<li>A custom web-page can be added to the HTTP server in order to provide 
	user interface;</li>
	<li>A custom dashboard sample code in FusionCharts was added;</li>
	<li>HTTP REST API JSON cubes list request added;</li>
	<li>Exporting current parameters in effect into a CSS file was added to the 
	settings page;</li>
	<li>A command line option to load styles from a custom CSS file was added;</li>
	<li>HTTP REST API JSON room list request bug fix;</li>
	<li>Updating the room name in the monitor pane upon renaming fixed.</li>
	</ul>
<P>
Changes (1 March 2020) to the version 3.13:<ul>
	<li>The update check was added to be about box.</li>
	</ul>
<P>
Changes (31 January 2020) to the version 3.12:<ul>
	<li>MQTT topic added to reflect device error state.</li>
	</ul>
<P>
Changes (14 January 2020) to the version 3.11:<ul>
	<li>The temperature scale of the graphs can be switched from auto-scaling to 
	fixed scale mode;</li>
	<li>The graph paper and refresh settings have effect on all graphs;</li>
	<li>The monitor pane was added to show graphical overview of all rooms.</li>
	</ul>
<P>
Changes (3 January 2020) to the version 3.10:<ul>
	<li>The order of cubes on the overview pane can be changed. The modified 
	order is then restored upon next application start.</li>
	</ul>
<P>
Changes (10 December 2019) to the version 3.9:<ul>
	<li>Bug in handling cube time skew fixed. The bug caused crashes on 32-bit 
	systems, e.g. armhf, when the cube's time was unset (detected as large time 
	difference to the host time);</li>
	<li>Linux dependencies of the prebuilt package are fixed.</li>
	</ul>
<P>
Changes (7 December 2019) to the version 3.8:<ul>
	<li>Exporting settings into and importing them from a text file was added;</li>
	<li>MQTT server persistent session rejection fix, when the number of 
	accumulated messages is too large;</li>
	<li>The size of output MQTT server messages buffer can be set.</li>
	</ul>
<P>
Changes (1 December 2019) to the version 3.7:<ul>
	<li>Database offset and valve columns insert bug fix;</li>
	<li>MQTT set mode topic added.</li>
	</ul>
<P>
Changes (24 November 2019) to the version 3.6:<ul>
	<li>Minor code improvements.</li>
	</ul>
<P>
Changes (21 November 2019) to the version 3.5:<ul>
	<li>LAN scanning dialog is improved, tooltip added;</li>
	<li>Debian and Ubuntu package dependencies fixed.</li>
	</ul>
<P>
Changes (2 November 2019) to the version 3.4:<ul>
	<li>Bug fix in the I/O worker task causing its exit;</li>
	<li>Added changing the thermostat's eco temperature per HTTP and MQTT.</li>
	</ul>
<P>
Changes (7 October 2019) to the version 3.3:<ul>
	<li>Bug fix in setting thermostat schedule;</li>
	<li>Bug fix in turning off the trace file append mode.</li>
	</ul>
<P>
Changes (6 August 2019) to the version 3.2:<ul>
	<li>Bug causing an existing trace file overridden when newly selected and 
	marked to append was fixed.</li>
	</ul>
<P>
Changes (6 August 2019) to the version 3.1:<ul>
	<li>The graph panes are ordered in the same order as the corresponding rooms 
	in the overview page;</li>
	<li>Reduced number of situations when an error popup dialog appear;</li>
	<li>Program crash when renaming a thermostat fixed;</li>
	<li>Bug fix when setting thermostat schedule remotely over HTTP.</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT Community 2018 (20180523-73)</i></li>
	<li>
<i>GNAT 8</i></li>
	<li>
<i>GNAT 9</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.15</i></li>
</ul>
<P>
Changes (18 May 2019) to the version 3.0:<ul>
	<li>Graph pane bug fixed. The bug prevent showing more than one graph tab 
	per cube;</li>
	<li>Bug fix in MQTT server that prevented it from start (indicated by 
	Constraint_Error in trace).</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT Community 2018 (20180523-73)</i></li>
	<li>
<i>GNAT 8</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.15</i></li>
</ul>
<P>
Changes (14 May 2019) to the version 2.18:<ul>
	<li>Thermostat scanning procedure's error handling has been improved;</li>
	<li>Indicating of faulty and orphaned devices was added;</li>
	<li>A button and dialog were added to remove faulty devices;</li>
	<li>Pairing devices was added;</li>
	<li>Devices and rooms renaming was added;</li>
	<li>Devices deletion was added;</li>
	<li>Devices wake up button has been added;</li>
	<li>Exporting devices to ELV MAX! software was added;</li>
	<li>Saving and restoring the topology of devices and rooms was added;</li>
	<li>Cube's NTP server setting was added;</li>
	<li>Tracing to file in appending mode added;</li>
	<li>When restoring configuration of devices or setting parameters of devices 
	the devices are woken up.</li>
	</ul>
<P>
Changes (11 Jan 2019) to the version 2.17:<ul>
	<li>Cube communication bug fix for 32-bit operating systems.</li>
	</ul>
<P>
Changes (8 Jan 2019) to the version 2.16:<ul>
	<li>Guards added against malfunctioned cubes.</li>
	</ul>
<P>
Changes (22 Dec 2018) to the version 2.15:<ul>
	<li>Python scripting exception handing changed to guard against invalid 
	object references;</li>
	<li>Loading Python library under Windows was improved for the cases when Python 
	is installed 
	in another directory, error hits were added;</li>
	<li>Python 3.7 support added;</li>
	<li>Python script settings bug fixed;</li>
	<li>The Valve positions average shown for the cubes on the overview pane;</li>
	<li>The Duty cycle queries were added to MQTT, HTTP and Python;</li>
	<li>GTK libraries for Windows 64-bit were replaced with the build having no 
	(or just lesser?) memory leak;</li>
	<li>Airing time getting/setting bug fix.</li>
	</ul>
<P>
Changes (11 Dec 2018) to the version 2.14:<ul>
	<li>Time indication rounding replaced with ceiling;</li>
	<li>Polling interval wait is continued rather than started over after 
	sending a command;</li>
	<li>Application exits immediately without waiting for expiration of the 
	polling interval;</li>
	<li>Python script set_mode can have only positional parameters;</li>
	<li>Python script set_mode <i>device</i> key was made equivalent to the <i>
	thermostat</i> key. Either spelling is acceptable;</li>
	<li>Python script get_connection, disconnect, reconnect were added to query 
	and manage the cube connection;</li>
	<li>Several cubes to connect to can be specified at the settings page;</li>
	<li>Added buttons to disconnect and reconnect to a cube;</li>
	<li>Cube connection state is now reflected in the cube icon, link icon and 
	connection/disconnection time stamp;</li>
	<li>HTTP server was enhanced with queries <i>get-connection</i>, <i>
	reconnect</i>, <i>
	disconnect</i>;</li>
	<li>MQTT broker changed to publish the cube connection status and to allow 
	controlling the cube connection.</li>
	</ul>
<P>
Changes (2 Dec 2018) to the version 2.13:<ul>
	<li>Indication of the time to the next polling of the cube;</li>
	<li>Scroll bars for the setting page panes;</li>
	<li>Wall thermostat display can be set to indicate measured or set 
	temperature.</li>
	</ul>
<P>
Changes (25 Nov 2018) to the version 2.12:<ul>
	<li>MQTT broker publishes link tokens for shutter contacts and thermostats;</li>
	<li>A thermostat schedule can be set using the MQTT broker or the HTTP 
	server;</li>
	<li>Tracing is extended.</li>
	</ul>
<P>
Changes (18 Nov 2018) to the version 2.11:<ul>
	<li>Bug fix in simultaneous mode change of multiple thermostats;</li>
	<li>Wall thermostat temperature offset added to the settings page. The 
	offset can be stored and restored. Legacy configuration files are still 
	eligible with the wall thermostat offset is defaulted to zero.</li>
	</ul>
<P>
Changes (9 Nov 2018) to the version 2.10:<ul>
	<li>Bug fix in the graph pane caused daylight saving shift;</li>
	<li>Bug fix in the MQTT broker.</li>
	</ul>
<P>
Changes (5 Aug 2018) to the version 2.9:<ul>
	<li>This version supports both 32-bit and natively 64-bit Windows.</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT 8</i></li>
	<li>
<i>GNAT 7</i></li>
	<li><i>GNAT 6</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.2</i></li>
</ul>
<P>
Changes (2 June 2018) to the version 2.8:<ul>
	<li>Handling faulty devices added;</li>
	<li>Calendar date selection dialog bug fixed (wrong month).</li>
	</ul>
<P>
Changes (4 May 2018) to the version 2.7:<ul>
	<li>Rooms and devices in the overview panel can be reordered. The order is 
	saved and restored by the next start;</li>
	<li>SSL/TLS tracing added;</li>
	<li>SMTP mail-client workarounds added to handle non-conform server 
	responses;</li>
	<li>Erroneous device state is indicated together with the link errors.</li>
	</ul>
<P>
Changes (10 February 2018) to the version 2.6:<ul>
	<li>Behavior under system load improved.</li>
	</ul>
<P>
Changes (1 February 2018) to the version 2.5:<ul>
	<li>Database logging bug fixed.</li>
	</ul>
<P>
Changes (28 January 2018) to the version 2.4:<ul>
	<li>Database errors recovery added. On errors connection is reopened and 
	failed record re-inserted;</li>
	<li>A check box added on the settings page to turn on and off adding the 
	valve offset to the set-temperature on the graphs pane;</li>
	<li>Memory leak fixed;</li>
	<li>The device name added to the response to the HTTP request get-status-csv;</li>
	<li>Tracing database operations added to the settings pane;</li>
	<li>Servicing requests under high CPU load was balanced to ensure cube 
	polling;</li>
	<li>Bug fixes in database communication;</li>
	<li>Minor bug fixes in saving and restoring settings.</li>
	</ul>
<P>
Changes (9 January 2018) to the version 2.3:<ul>
	<li>HTTP queries get-rooms-list and get-rooms-json-list were added to get 
	the list of rooms with the device addresses in each room.</li>
	</ul>
<P>
Changes (6 January 2018) to the version 2.2:<ul>
	<li>Minor bug fixed;</li>
	<li>Example of controlling a relay from a script.</li>
	</ul>
<P>
Changes (26 December 2017) to the version 2.1:<ul>
	<li>Extended trace option added;</li>
	<li>Added trace to file option.</li>
	</ul>
<P>
Changes (21 December 2017) to the version 2.0:<ul>
	<li>MQTT maximum connections and subscriptions settings added.</li>
	</ul>
<P>
Changes (18 December 2017) to the version 1.12:<ul>
	<li>MQTT broker bug fix that prevented publishing thermostat temperatures;</li>
	<li>MQTT broker settings allow specifying if the broker should accept 
	publishing requests from the clients on unknown topics. The topics can be 
	limited by a list of MQTT topic patterns.</li>
	<li>Python scripts added.</li>
	</ul>
<P>
Changes (26 November 2017) to the version 1.11:<ul>
	<li>Saving and restoring wall thermostat settings added.</li>
	</ul>
<P>
Changes (5 September 2017) to the version 1.10:<ul>
	<li>Preview window added to the configuration file chooser dialog;</li>
	<li>Restoring configuration from a file is made more lenient towards data 
	format errors.</li>
	</ul>
<P>
Changes (26 July 2017) to the version 1.9:<ul>
	<li>HTTP requests added to get the average, maximum, minimum valve 
	positions;</li>
	<li>MQTT topics added to subscribe to the average, maximum, minimum valve 
	positions.</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i>
<ul>
  <li>
<i>GNAT GPL 2016 (20160515-49)</i></li>
	<li><i>GNAT 6</i></li>
  </ul>
<P><i>and the GtkAda versions:</i></p>
<ul>
	<li><i>GtkAda 3.14.2</i></li>
</ul>
<P>
Changes (18 April 2017) to the version 1.8:<ul>
	<li>MQTT on WebSockets added;</li>
	<li>The MQTT server's topic names have the leading '/' removed because some 
	MQTT clients reported having troubles with names starting with '/';</li>
	<li>When controlled over HTTP or MQTT the target temperature can be 
	specified to be airing, comfort, and eco according to the thermostat 
	settings;</li>
	<li>The thermostat address can be omitted when in control commands over HTTP 
	or MQTT. In this case the command applies to all thermostats;</li>
	<li>HTTP access control (CORS) support added;</li>
	<li>HTTP server JSONP support added.</li>
	</ul>
<P>
Changes (22 February 2017) to the version 1.7:<ul>
	<li>Save changes warning dialog on schedule tab closing;</li>
	<li>The thermostat temperature can be set in the automatic mode;</li>
	<li>The graph page contains set temperature + offset curve;</li>
	<li>Various minor bug fixes;</li>
	<li>Data logger added. The logger is backed by a database accessed either 
	through ODBC or by SQLite.</li>
	</ul>
<P>
Changes (5 February 2017) to the version 1.6:<ul>
	<li>Multiple selection is supported, e.g. to change the modes of all 
	thermostats;</li>
	<li>E-mail reports of the devices which batteries are low;</li>
	<li>Bug fix in the wall thermostat parameters setting page;</li>
	<li>CSV output of device status reports queried through HTTP;</li>
	<li>Graph page contains valve position curves.</li>
	</ul>
<P>
Changes (21 November 2016) to the version 1.5:<ul>
	<li>Monitoring duty cycle was added;</li>
	<li>Commands that control thermostats are serialized and monitored for 
	failures;</li>
	<li>Cube radiator thermostats configuration save and restore added;</li>
	<li>Thermostat schedule and parameters upload diagnostics added;</li>
	<li>Offset temperature can be set negative;</li>
	<li>HTTP server request documentation <i>get-set_temperature</i> changed to
	<i>get-set-temperature</i>;</li>
	<li>Save file dialogs ask override confirmation;</li>
	<li>Bug fix in HTTP server that prevented querying the thermostat's measured 
	temperature;</li>
	<li>Valve position is correctly reported;</li>
	<li>Thermostat parameters and schedule optimized to minimize RF traffic;</li>
	<li>Documentation extended with instructions how to run the application 
	remotely or in the headless mode.</li>
	</ul>
<P>
Changes (25 July 2016) to the version 1.4:<ul>
	<li>Compatibility with GtkAda 3.14</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i><ul>
	<li><i>GNAT GPL 2015 (20150428-49)</i></li>
	<li><i>GNAT 5.3</i></li>
	<li><i>GNAT 6</i></li>
  </ul>
<P>
<i>and the GtkAda versions:</i><ul>
	<li><i>GtkAda 3.8.3</i></li>
	</ul>
<P>
Changes (31 May 2016) to the version 1.3:<ul>
	<li>Debian version is moved to gcc-6;</li>
	<li>Minor bug fixes in the MQTT server.</li>
	</ul>
<P>
<i>
The following versions were tested with the compilers:</i><ul>
	<li><i>GNAT GPL 2015 (20150428-49)</i></li>
	<li><i>GNAT 5.3</i></li>
  </ul>
<P>
<i>and the GtkAda versions:</i><ul>
	<li><i>GtkAda 3.8.3</i></li>
	</ul>
<P>
Changes (13 April 2016) to the version 1.2:<ul>
	<li>MQTT server added;</li>
	<li>LAN discovery by default scans all known interfaces;</li>
	<li>Settings page allows explicit setting of the host address to scan or 
	cube address to connect.</li>
	</ul>
<P>
Changes (5 March 2016) to the version 1.1:<ul>
	<li>Scanning radiator thermostats technique implemented;</li>
	<li>Graphs page changed to indicate radiator thermostat temperatures.</li>
	</ul>
<P>
Changes (18 October 2015) to the version 1.0:<ul>
	<li>Wall thermostat support;</li>
	<li>Graphs page to represent wall-mounted thermostat temperatures as running 
	curves;</li>
	<li>Integrated HTTP server for remote control and automation;</li>
	<li>Bug fixes.</li>
	</ul>
<p>Version 1.0 released (24 August 2015).</p>
<hr>
<p align="right">
  <a name="9"></a><a href="#8"><IMG src="prev.gif" alt="[Back]" width="29"
      height="29"></a><a href="#9"><IMG src="index.gif"
      alt="[TOC]" width="29" height="29"></a></p>
<H2>9. Table of Contents</H2>
<table border="0" cellpadding="0" cellspacing="20">
<tr><td valign="top">
<b><font size="5">1 </font></b><a href="#1"><font size="4">Use</font></a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.1">1.1. Overview pane</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.2">1.2. Thermostat settings pane</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.3">1.3. Trace pane</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.4">1.4. Graphs and monitor panes</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.5">1.5. Scanning temperatures measured by radiator thermostat</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.6">1.6. Cube discovery</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#1.7">1.7. Saving and restoring thermostat configurations</a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.8">1.8. Pairing devices and creating rooms</a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.9">1.9. Deleting devices and rooms</a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.10">1.10. Resetting the cube</a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.11">1.11. Interaction with ELV MAX! software</a><br>
&nbsp;&nbsp;&nbsp;<a href="#1.12">1.12. Preset buttons</a><hr>
<b><font size="5">2 </font></b><A href="#2"><font size="4">HTTP automation (REST 
API)</font></A><br>
&nbsp;&nbsp;&nbsp;<a href="#2.1">2.1. Querying a device status</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.2">2.2. Setting thermostats into automatic mode</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.3">2.3. Setting thermostats into boost mode</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.4">2.4. Setting thermostats into manual mode</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.5">2.5. Setting thermostats into vacation mode</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.6">2.6. Setting thermostat's schedule</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.7">2.7. Controlling cube connection</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.8">2.8. Setting thermostat parameters</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#2.9">2.9. Custom web page</a></td>
<td valign="top">
<b><font size="5">3 </font></b><a href="#3"><font size="4">MQTT automation</font></a><BR>
&nbsp;&nbsp;&nbsp;<a href="#3.1">3.1. Publishing topics</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#3.2">3.2. Controlling thermostats</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#3.3">3.3. Controlling cube connection</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#3.4">3.4. Externally published topics</a><hr>
<b><font size="5">4 </font></b><a href="#4"><font size="4">Logging into a database</font></a><BR>
&nbsp;&nbsp;&nbsp;<a href="#4.1">4.1. Database configuration</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#4.2">4.2. The database structure</a>
<hr>
<b><font size="5">5 </font></b><a href="#5"><font size="4">Scrpting</font></a><BR>
&nbsp;&nbsp;&nbsp;<a href="#5.1">5.1. Python scripting</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#5.2">5.2. Python module elv_max_cube</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#5.3">5.3. Maintaining state between calls of the script</a><br>
&nbsp;&nbsp;&nbsp;<a href="#5.4">5.4. Controlling a boiler with an ESP8266 and a relay</a><br>
&nbsp;&nbsp;&nbsp;<a href="#5.5">5.5. Controlling a boiler using a MAX! switch</a><br>
&nbsp;&nbsp;&nbsp;<a href="#5.6">5.6. Julia scripting</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#5.7">5.7. Julia module ELV_MAX_Cube</a></td>
<td valign="top">
<b><font size="5">6 </font></b><a href="#6"><font size="4">Runnung headless and 
other issues</font></a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.1">6.1. Headless</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.2">6.2. Running remotely</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.3">6.3. Permission denied</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.4">6.4. Settings file</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.5">6.5. dbind-WARNING</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.6">6.6. Styles, languages, icons etc</a><BR>
&nbsp;&nbsp;&nbsp;<a href="#6.7">6.7. CSS file template</a><hr>
<b><font size="5">7 </font></b><a href="#7"><font size="4">Building from sources</font></a><hr>
<b><font size="5">8 </font></b><a href="#8"><font size="4">Changes log</font></a><hr>
<b><font size="5">9 </font></b><a href="#9"><font size="4">Table of Contents</font></a></td>
</tr>
</table>
</BODY></HTML>
